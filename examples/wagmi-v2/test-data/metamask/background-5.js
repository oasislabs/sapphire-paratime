LavaPack.loadBundle([[592,{"@ethereumjs/tx":438,"@ethereumjs/util":450,"@keystonehq/bc-ur-registry-eth":598,buffer:3497,hdkey:4084,rlp:595,uuid:4873},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){function n(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(r,"__esModule",{value:!0});var s=n(e("hdkey")),i=e("@ethereumjs/util"),a=n(e("rlp")),o=e("@ethereumjs/tx"),c=e("@keystonehq/bc-ur-registry-eth"),u=e("uuid");const l="QR Hardware Wallet Device",d="m",h="0/*";var f,p;!function(e){e.hd="hd",e.pubkey="pubkey"}(f||(f={})),function(e){e.standard="account.standard",e.ledger_live="account.ledger_live",e.ledger_legacy="account.ledger_legacy"}(p||(p={}));class g{constructor(e){this.version=1,this.getInteraction=()=>{throw new Error("KeystoneError#invalid_extends: method getInteraction not implemented, please extend BaseKeyring by overwriting this method.")},this.type=l,this.requestSignature=async(e,t,r,n)=>{const s=await this.getInteraction().requestSignature(t,r,n),i=s.getRequestId(),a=s.getSignature();if(i){if(u.stringify(i)!==e)throw new Error("KeystoneError#invalid_data: read signature error: mismatched requestId")}return{r:a.slice(0,32),s:a.slice(32,64),v:a.slice(64)}},this.__readCryptoHDKey=e=>{var t,r;const n=`m/${e.getOrigin().getPath()}`,s=null==(t=e.getOrigin().getSourceFingerprint())?void 0:t.toString("hex"),i=(null==(r=e.getChildren())?void 0:r.getPath())||h,a=e.getName();if(e.getNote()===p.standard?this.keyringAccount=p.standard:e.getNote()===p.ledger_legacy&&(this.keyringAccount=p.ledger_legacy),!s)throw new Error("KeystoneError#invalid_data: invalid crypto-hdkey, cannot get source fingerprint");const o=e.getBip32Key();this.xfp=s,this.xpub=o,this.hdPath=n,this.childrenPath=i,a!==undefined&&""!==a&&(this.name=a),this.initialized=!0},this.__readCryptoAccount=e=>{var t,r;const n=null==(t=e.getMasterFingerprint())?void 0:t.toString("hex");if(!n)throw new Error("KeystoneError#invalid_data: invalid crypto-account, cannot get master fingerprint");this.xfp=n,this.initialized=!0;let s=!1;const a=e.getOutputDescriptors();if(!a||0===a.length)throw new Error("KeystoneError#invalid_data: invalid crypto-account, no crypto output found");if(a.length%5!=0)throw new Error("KeystoneError#invalid_data: only support 5x pubkey accounts for now");return null==(r=e.getOutputDescriptors())||r.forEach((e=>{try{const t=e.getHDKey();if(t){const e=t.getKey(),r=`M/${t.getOrigin().getPath()}`,n="0x"+i.publicToAddress(e,!0).toString("hex");this.name=t.getName(),t.getNote()===p.ledger_live&&(this.keyringAccount=p.ledger_live),this.paths[i.toChecksumAddress(n)]===undefined&&(s=!0),this.paths[i.toChecksumAddress(n)]=r}}catch(e){throw new Error(`KeystoneError#invalid_data: ${e}`)}})),s},this.getName=()=>this.name,this.setAccountToUnlock=e=>{this.unlockedAccount=parseInt(e,10)},this.__getNormalPage=async e=>{this.page+=e,this.page<=0&&(this.page=1);const t=(this.page-1)*this.perPage,r=t+this.perPage,n=[];for(let e=t;e<r;e++){const t=await this.__addressFromIndex(d,e);n.push({address:t,balance:null,index:e}),this.indexes[i.toChecksumAddress(t)]=e}return n},this.__getLedgerLivePage=async e=>{const t=(this.page+e-1)*this.perPage,r=t+this.perPage,n=[];for(let e=t;e<r;e++){const t=await this.__addressFromIndex(d,e);n.push({address:t,balance:null,index:e})}return this.page+=e,n},this.__addressFromIndex=async(e,t)=>{if(this.keyringMode===f.hd){this.checkKeyring(),this.hdk||(this.hdk=s.fromExtendedKey(this.xpub));const r=this.childrenPath.replace("*",String(t)).replace(/\*/g,"0"),n=this.hdk.derive(`${e}/${r}`),a="0x"+i.publicToAddress(n.publicKey,!0).toString("hex");return i.toChecksumAddress(a)}{const e=Object.keys(this.paths)[t];if(e)return i.toChecksumAddress(e);throw new Error("KeystoneError#pubkey_account.no_expected_account")}},this.page=0,this.perPage=5,this.accounts=[],this.currentAccount=0,this.unlockedAccount=0,this.name="QR Hardware",this.keyringMode=f.hd,this.keyringAccount=p.standard,this.initialized=!1,this.xfp="",this.xpub="",this.hdPath="",this.childrenPath=h,this.indexes={},this.paths={},this.deserialize(e)}async readKeyring(){const e=await this.getInteraction().readCryptoHDKeyOrCryptoAccount();this.syncKeyring(e)}syncKeyring(e){e.getRegistryType().getType()===c.extend.RegistryTypes.CRYPTO_HDKEY.getType()?(this.keyringMode=f.hd,this.__readCryptoHDKey(e)):(this.keyringMode=f.pubkey,this.__readCryptoAccount(e))}checkKeyring(){if(!this.xfp||!this.xpub||!this.hdPath)throw new Error("KeystoneError#invalid_keyring: keyring not fulfilled, please call function `readKeyring` firstly")}serialize(){return Promise.resolve({initialized:this.initialized,accounts:this.accounts,currentAccount:this.currentAccount,page:this.page,perPage:this.perPage,keyringAccount:this.keyringAccount,keyringMode:this.keyringMode,name:this.name,version:this.version,xfp:this.xfp,xpub:this.xpub,hdPath:this.hdPath,childrenPath:this.childrenPath,indexes:this.indexes,paths:this.paths})}deserialize(e){e&&(this.accounts=e.accounts,this.currentAccount=e.currentAccount,this.page=e.page,this.perPage=e.perPage,this.name=e.name,this.initialized=e.initialized,this.keyringMode=e.keyringMode||f.hd,this.keyringAccount=e.keyringAccount||p.standard,this.xfp=e.xfp,this.xpub=e.xpub,this.hdPath=e.hdPath,this.indexes=e.indexes,this.paths=e.paths,this.childrenPath=e.childrenPath||h)}setCurrentAccount(e){this.currentAccount=e}getCurrentAccount(){return this.currentAccount}getCurrentAddress(){return this.accounts[this.currentAccount]}async addAccounts(e=1){const t=this.unlockedAccount,r=t+e,n=[];for(let e=t;e<r;e++){const t=await this.__addressFromIndex(d,e);n.push(t),this.page=0,this.unlockedAccount++}return this.accounts=this.accounts.concat(n),this.accounts}getFirstPage(){return this.page=0,this.__getPage(1)}getNextPage(){return this.__getPage(1)}getPreviousPage(){return this.__getPage(-1)}async __getPage(e){return this.initialized||await this.readKeyring(),this.keyringMode===f.hd?this.__getNormalPage(e):this.__getLedgerLivePage(e)}getAccounts(){return Promise.resolve(this.accounts)}removeAccount(e){if(!this.accounts.map((e=>e.toLowerCase())).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter((t=>t.toLowerCase()!==e.toLowerCase()))}async signTransaction(e,r){const n=0===r.type?c.DataType.transaction:c.DataType.typedTransaction;let s;s=0===r.type?t.from(a.encode(r.getMessageToSign(!1))):r.getMessageToSign(!1);const i=await this._pathFromAddress(e),l=Number(r.common.chainId()),d=u.v4(),h=c.EthSignRequest.constructETHRequest(s,n,i,this.xfp,d,l),{r:f,s:p,v:g}=await this.requestSignature(d,h,"Scan with your Keystone",'After your Keystone has signed the transaction, click on "Scan Keystone" to receive the signature');return o.TransactionFactory.fromTxData({...r.toJSON(),type:r.type,r:f,s:p,v:g},{common:r.common})}signMessage(e,t){return this.signPersonalMessage(e,t)}async signPersonalMessage(e,r){const n=i.stripHexPrefix(r),s=await this._pathFromAddress(e),a=u.v4(),o=c.EthSignRequest.constructETHRequest(t.from(n,"hex"),c.DataType.personalMessage,s,this.xfp,a,undefined,e),{r:l,s:d,v:h}=await this.requestSignature(a,o,"Scan with your Keystone",'After your Keystone has signed this message, click on "Scan Keystone" to receive the signature');return"0x"+t.concat([l,d,h]).toString("hex")}async signTypedData(e,r){const n=await this._pathFromAddress(e),s=u.v4(),i=c.EthSignRequest.constructETHRequest(t.from(JSON.stringify(r),"utf-8"),c.DataType.typedData,n,this.xfp,s,undefined,e),{r:a,s:o,v:l}=await this.requestSignature(s,i,"Scan with your Keystone",'After your Keystone has signed this data, click on "Scan Keystone" to receive the signature');return"0x"+t.concat([a,o,l]).toString("hex")}async _pathFromAddress(e){if(this.keyringMode===f.hd){const t=i.toChecksumAddress(e);let r=this.indexes[t];if(void 0===r)for(let e=0;e<1e3;e++)if(t===await this.__addressFromIndex(d,e)){r=e;break}if(void 0===r)throw new Error("Unknown address");return`${this.hdPath}/${this.childrenPath.replace("*",r.toString()).replace(/\*/g,"0")}`}{const t=i.toChecksumAddress(e),r=this.paths[t];if(void 0===r)throw new Error("Unknown address");return r}}}g.type=l,r.BaseKeyring=g}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@keystonehq/metamask-airgapped-keyring>@keystonehq/base-eth-keyring",file:"node_modules/@keystonehq/base-eth-keyring/dist/base-eth-keyring.cjs.development.js"}],[593,{"@ethereumjs/tx":438,"@ethereumjs/util":450,"@keystonehq/bc-ur-registry-eth":598,buffer:3497,hdkey:4084,rlp:595,uuid:4873},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){function n(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(r,"__esModule",{value:!0});var s,i,a=n(e("hdkey")),o=e("@ethereumjs/util"),c=n(e("rlp")),u=e("@ethereumjs/tx"),l=e("@keystonehq/bc-ur-registry-eth"),d=e("uuid");!function(e){e.hd="hd",e.pubkey="pubkey"}(s||(s={})),function(e){e.standard="account.standard",e.ledger_live="account.ledger_live",e.ledger_legacy="account.ledger_legacy"}(i||(i={}));class h{constructor(e){this.version=1,this.getInteraction=()=>{throw new Error("KeystoneError#invalid_extends: method getInteraction not implemented, please extend BaseKeyring by overwriting this method.")},this.type="QR Hardware Wallet Device",this.requestSignature=async(e,t,r,n)=>{const s=await this.getInteraction().requestSignature(t,r,n),i=s.getRequestId(),a=s.getSignature();if(i&&d.stringify(i)!==e)throw new Error("KeystoneError#invalid_data: read signature error: mismatched requestId");return{r:a.slice(0,32),s:a.slice(32,64),v:a.slice(64)}},this.__readCryptoHDKey=e=>{var t,r;const n="m/"+e.getOrigin().getPath(),s=null==(t=e.getOrigin().getSourceFingerprint())?void 0:t.toString("hex"),a=(null==(r=e.getChildren())?void 0:r.getPath())||"0/*",o=e.getName();if(e.getNote()===i.standard?this.keyringAccount=i.standard:e.getNote()===i.ledger_legacy&&(this.keyringAccount=i.ledger_legacy),!s)throw new Error("KeystoneError#invalid_data: invalid crypto-hdkey, cannot get source fingerprint");const c=e.getBip32Key();this.xfp=s,this.xpub=c,this.hdPath=n,this.childrenPath=a,void 0!==o&&""!==o&&(this.name=o),this.initialized=!0},this.__readCryptoAccount=e=>{var t,r;const n=null==(t=e.getMasterFingerprint())?void 0:t.toString("hex");if(!n)throw new Error("KeystoneError#invalid_data: invalid crypto-account, cannot get master fingerprint");this.xfp=n,this.initialized=!0;let s=!1;const a=e.getOutputDescriptors();if(!a||0===a.length)throw new Error("KeystoneError#invalid_data: invalid crypto-account, no crypto output found");if(a.length%5!=0)throw new Error("KeystoneError#invalid_data: only support 5x pubkey accounts for now");return null==(r=e.getOutputDescriptors())||r.forEach((e=>{try{const t=e.getHDKey();if(t){const e=t.getKey(),r="M/"+t.getOrigin().getPath(),n="0x"+o.publicToAddress(e,!0).toString("hex");this.name=t.getName(),t.getNote()===i.ledger_live&&(this.keyringAccount=i.ledger_live),void 0===this.paths[o.toChecksumAddress(n)]&&(s=!0),this.paths[o.toChecksumAddress(n)]=r}}catch(e){throw new Error("KeystoneError#invalid_data: "+e)}})),s},this.getName=()=>this.name,this.setAccountToUnlock=e=>{this.unlockedAccount=parseInt(e,10)},this.__getNormalPage=async e=>{this.page+=e,this.page<=0&&(this.page=1);const t=(this.page-1)*this.perPage,r=t+this.perPage,n=[];for(let e=t;e<r;e++){const t=await this.__addressFromIndex("m",e);n.push({address:t,balance:null,index:e}),this.indexes[o.toChecksumAddress(t)]=e}return n},this.__getLedgerLivePage=async e=>{const t=(this.page+e-1)*this.perPage,r=t+this.perPage,n=[];for(let e=t;e<r;e++){const t=await this.__addressFromIndex("m",e);n.push({address:t,balance:null,index:e})}return this.page+=e,n},this.__addressFromIndex=async(e,t)=>{if(this.keyringMode===s.hd){this.checkKeyring(),this.hdk||(this.hdk=a.fromExtendedKey(this.xpub));const r=this.childrenPath.replace("*",String(t)).replace(/\*/g,"0"),n=this.hdk.derive(`${e}/${r}`),s="0x"+o.publicToAddress(n.publicKey,!0).toString("hex");return o.toChecksumAddress(s)}{const e=Object.keys(this.paths)[t];if(e)return o.toChecksumAddress(e);throw new Error("KeystoneError#pubkey_account.no_expected_account")}},this.page=0,this.perPage=5,this.accounts=[],this.currentAccount=0,this.unlockedAccount=0,this.name="QR Hardware",this.keyringMode=s.hd,this.keyringAccount=i.standard,this.initialized=!1,this.xfp="",this.xpub="",this.hdPath="",this.childrenPath="0/*",this.indexes={},this.paths={},this.deserialize(e)}async readKeyring(){const e=await this.getInteraction().readCryptoHDKeyOrCryptoAccount();this.syncKeyring(e)}syncKeyring(e){e.getRegistryType().getType()===l.extend.RegistryTypes.CRYPTO_HDKEY.getType()?(this.keyringMode=s.hd,this.__readCryptoHDKey(e)):(this.keyringMode=s.pubkey,this.__readCryptoAccount(e))}checkKeyring(){if(!this.xfp||!this.xpub||!this.hdPath)throw new Error("KeystoneError#invalid_keyring: keyring not fulfilled, please call function `readKeyring` firstly")}serialize(){return Promise.resolve({initialized:this.initialized,accounts:this.accounts,currentAccount:this.currentAccount,page:this.page,perPage:this.perPage,keyringAccount:this.keyringAccount,keyringMode:this.keyringMode,name:this.name,version:this.version,xfp:this.xfp,xpub:this.xpub,hdPath:this.hdPath,childrenPath:this.childrenPath,indexes:this.indexes,paths:this.paths})}deserialize(e){e&&(this.accounts=e.accounts,this.currentAccount=e.currentAccount,this.page=e.page,this.perPage=e.perPage,this.name=e.name,this.initialized=e.initialized,this.keyringMode=e.keyringMode||s.hd,this.keyringAccount=e.keyringAccount||i.standard,this.xfp=e.xfp,this.xpub=e.xpub,this.hdPath=e.hdPath,this.indexes=e.indexes,this.paths=e.paths,this.childrenPath=e.childrenPath||"0/*")}setCurrentAccount(e){this.currentAccount=e}getCurrentAccount(){return this.currentAccount}getCurrentAddress(){return this.accounts[this.currentAccount]}async addAccounts(e=1){const t=this.unlockedAccount,r=t+e,n=[];for(let e=t;e<r;e++){const t=await this.__addressFromIndex("m",e);n.push(t),this.page=0,this.unlockedAccount++}return this.accounts=this.accounts.concat(n),this.accounts}getFirstPage(){return this.page=0,this.__getPage(1)}getNextPage(){return this.__getPage(1)}getPreviousPage(){return this.__getPage(-1)}async __getPage(e){return this.initialized||await this.readKeyring(),this.keyringMode===s.hd?this.__getNormalPage(e):this.__getLedgerLivePage(e)}getAccounts(){return Promise.resolve(this.accounts)}removeAccount(e){if(!this.accounts.map((e=>e.toLowerCase())).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter((t=>t.toLowerCase()!==e.toLowerCase()))}async signTransaction(e,r){const n=0===r.type?l.DataType.transaction:l.DataType.typedTransaction;let s;s=0===r.type?t.from(c.encode(r.getMessageToSign(!1))):r.getMessageToSign(!1);const i=await this._pathFromAddress(e),a=Number(r.common.chainId()),o=d.v4(),h=l.EthSignRequest.constructETHRequest(s,n,i,this.xfp,o,a),{r:f,s:p,v:g}=await this.requestSignature(o,h,"Scan with your Keystone",'After your Keystone has signed the transaction, click on "Scan Keystone" to receive the signature');return u.TransactionFactory.fromTxData({...r.toJSON(),type:r.type,r:f,s:p,v:g},{common:r.common})}signMessage(e,t){return this.signPersonalMessage(e,t)}async signPersonalMessage(e,r){const n=o.stripHexPrefix(r),s=await this._pathFromAddress(e),i=d.v4(),a=l.EthSignRequest.constructETHRequest(t.from(n,"hex"),l.DataType.personalMessage,s,this.xfp,i,void 0,e),{r:c,s:u,v:h}=await this.requestSignature(i,a,"Scan with your Keystone",'After your Keystone has signed this message, click on "Scan Keystone" to receive the signature');return"0x"+t.concat([c,u,h]).toString("hex")}async signTypedData(e,r){const n=await this._pathFromAddress(e),s=d.v4(),i=l.EthSignRequest.constructETHRequest(t.from(JSON.stringify(r),"utf-8"),l.DataType.typedData,n,this.xfp,s,void 0,e),{r:a,s:o,v:c}=await this.requestSignature(s,i,"Scan with your Keystone",'After your Keystone has signed this data, click on "Scan Keystone" to receive the signature');return"0x"+t.concat([a,o,c]).toString("hex")}async _pathFromAddress(e){if(this.keyringMode===s.hd){const t=o.toChecksumAddress(e);let r=this.indexes[t];if(void 0===r)for(let e=0;e<1e3;e++)if(t===await this.__addressFromIndex("m",e)){r=e;break}if(void 0===r)throw new Error("Unknown address");return`${this.hdPath}/${this.childrenPath.replace("*",r.toString()).replace(/\*/g,"0")}`}{const t=o.toChecksumAddress(e),r=this.paths[t];if(void 0===r)throw new Error("Unknown address");return r}}}h.type="QR Hardware Wallet Device",r.BaseKeyring=h}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@keystonehq/metamask-airgapped-keyring>@keystonehq/base-eth-keyring",file:"node_modules/@keystonehq/base-eth-keyring/dist/base-eth-keyring.cjs.production.min.js"}],[594,{"./base-eth-keyring.cjs.development.js":592,"./base-eth-keyring.cjs.production.min.js":593},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=e("./base-eth-keyring.cjs.production.min.js")}}},{package:"@keystonehq/metamask-airgapped-keyring>@keystonehq/base-eth-keyring",file:"node_modules/@keystonehq/base-eth-keyring/dist/index.js"}],[595,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){function n(e){if(Array.isArray(e)){const t=[];for(let r=0;r<e.length;r++)t.push(n(e[r]));const r=f(...t);return f(a(r.length,192),r)}const t=y(e);return 1===t.length&&t[0]<128?t:f(a(t.length,128),t)}function s(e,t,r){if(r>e.length)throw new Error("invalid RLP (safeSlice): end slice of Uint8Array out-of-bounds");return e.slice(t,r)}function i(e){if(0===e[0])throw new Error("invalid RLP: extra zeros");return d(l(e))}function a(e,t){if(e<56)return Uint8Array.from([e+t]);const r=g(e),n=g(t+55+r.length/2);return Uint8Array.from(h(n+r))}function o(e,t=!1){if(!e||0===e.length)return Uint8Array.from([]);const r=c(y(e));if(t)return r;if(0!==r.remainder.length)throw new Error("invalid RLP: remainder must be zero");return r.data}function c(e){let t,r,n,a,o;const u=[],l=e[0];if(l<=127)return{data:e.slice(0,1),remainder:e.slice(1)};if(l<=183){if(t=l-127,n=128===l?Uint8Array.from([]):s(e,1,t),2===t&&n[0]<128)throw new Error("invalid RLP encoding: invalid prefix, single byte < 0x80 are not prefixed");return{data:n,remainder:e.slice(t)}}if(l<=191){if(r=l-182,e.length-1<r)throw new Error("invalid RLP: not enough bytes for string length");if(t=i(s(e,1,r)),t<=55)throw new Error("invalid RLP: expected string length to be greater than 55");return n=s(e,r,t+r),{data:n,remainder:e.slice(t+r)}}if(l<=247){for(t=l-191,a=s(e,1,t);a.length;)o=c(a),u.push(o.data),a=o.remainder;return{data:u,remainder:e.slice(t)}}{if(r=l-246,t=i(s(e,1,r)),t<56)throw new Error("invalid RLP: encoded list too short");const n=r+t;if(n>e.length)throw new Error("invalid RLP: total length is larger than the data");for(a=s(e,r,n);a.length;)o=c(a),u.push(o.data),a=o.remainder;return{data:u,remainder:e.slice(n)}}}Object.defineProperty(r,"__esModule",{value:!0}),r.utils=r.decode=r.encode=void 0,r.encode=n,r.decode=o;const u=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function l(e){let t="";for(let r=0;r<e.length;r++)t+=u[e[r]];return t}function d(e){const t=Number.parseInt(e,16);if(Number.isNaN(t))throw new Error("Invalid byte sequence");return t}function h(e){if("string"!=typeof e)throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){const n=2*r;t[r]=d(e.slice(n,n+2))}return t}function f(...e){if(1===e.length)return e[0];const t=e.reduce(((e,t)=>e+t.length),0),r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const s=e[t];r.set(s,n),n+=s.length}return r}function p(e){return(new TextEncoder).encode(e)}function g(e){if(e<0)throw new Error("Invalid integer as argument, must be unsigned!");const t=e.toString(16);return t.length%2?`0${t}`:t}function m(e){return e.length>=2&&"0"===e[0]&&"x"===e[1]}function y(e){if(e instanceof Uint8Array)return e;if("string"==typeof e)return m(e)?h((t="string"!=typeof(r=e)?r:m(r)?r.slice(2):r).length%2?`0${t}`:t):p(e);var t,r;if("number"==typeof e||"bigint"==typeof e)return e?h(g(e)):Uint8Array.from([]);if(null===e||e===undefined)return Uint8Array.from([]);throw new Error("toBytes: received unsupported type "+typeof e)}r.utils={bytesToHex:l,concatBytes:f,hexToBytes:h,utf8ToBytes:p};const b={encode:n,decode:o};r.default=b}}},{package:"@keystonehq/metamask-airgapped-keyring>@keystonehq/base-eth-keyring>rlp",file:"node_modules/@keystonehq/base-eth-keyring/node_modules/rlp/dist/index.js"}],[5997,{"../../../app/scripts/controllers/bridge/types":15,"../../../shared/constants/bridge":4944,"../../../shared/constants/time":4971,"../../../shared/lib/fetch-with-cache":4977,"../../../shared/lib/swaps-utils":4982,"../../../shared/modules/conversion.utils":4993,"@metamask/utils":2717},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.fetchBridgeFeatureFlags=async function(){const e=`${a.BRIDGE_API_BASE_URL}/getAllFeatureFlags`,t=await(0,c.default)({url:e,fetchOptions:{method:"GET",headers:d},cacheOptions:{cacheRefreshTime:h},functionName:"fetchBridgeFeatureFlags"});if(p([{property:f.EXTENSION_SUPPORT,type:"boolean",validator:e=>"boolean"==typeof e},{property:f.NETWORK_SRC_ALLOWLIST,type:"object",validator:e=>Object.values(e).every((e=>"number"==typeof e))},{property:f.NETWORK_DEST_ALLOWLIST,type:"object",validator:e=>Object.values(e).every((e=>"number"==typeof e))}],t,e))return{[i.BridgeFeatureFlagsKey.EXTENSION_SUPPORT]:t[f.EXTENSION_SUPPORT],[i.BridgeFeatureFlagsKey.NETWORK_SRC_ALLOWLIST]:t[f.NETWORK_SRC_ALLOWLIST].map((e=>(0,s.add0x)((0,l.decimalToHex)(e)))),[i.BridgeFeatureFlagsKey.NETWORK_DEST_ALLOWLIST]:t[f.NETWORK_DEST_ALLOWLIST].map((e=>(0,s.add0x)((0,l.decimalToHex)(e))))};return{[i.BridgeFeatureFlagsKey.EXTENSION_SUPPORT]:!1,[i.BridgeFeatureFlagsKey.NETWORK_SRC_ALLOWLIST]:[],[i.BridgeFeatureFlagsKey.NETWORK_DEST_ALLOWLIST]:[]}};var n,s=e("@metamask/utils"),i=e("../../../app/scripts/controllers/bridge/types"),a=e("../../../shared/constants/bridge"),o=e("../../../shared/constants/time"),c=(n=e("../../../shared/lib/fetch-with-cache"))&&n.__esModule?n:{default:n},u=e("../../../shared/lib/swaps-utils"),l=e("../../../shared/modules/conversion.utils");const d={"X-Client-Id":a.BRIDGE_CLIENT_ID},h=10*o.MINUTE;var f=function(e){return e.EXTENSION_SUPPORT="extension-support",e.NETWORK_SRC_ALLOWLIST="src-network-allowlist",e.NETWORK_DEST_ALLOWLIST="dest-network-allowlist",e}(f||{});const p=(e,t,r)=>(0,u.validateData)(e,t,r)}}},{package:"$root$",file:"ui/pages/bridge/bridge.util.ts"}],[6,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.COOKIE_ID_MARKETING_WHITELIST_ORIGINS=r.COOKIE_ID_MARKETING_WHITELIST=void 0;const n=r.COOKIE_ID_MARKETING_WHITELIST=["https://metamask.io","https://learn.metamask.io","https://mmi-support.zendesk.com","https://community.metamask.io","https://support.metamask.io"];r.COOKIE_ID_MARKETING_WHITELIST_ORIGINS=n.map((e=>new URL(e).origin))}}},{package:"$root$",file:"app/scripts/constants/marketing-site-whitelist.ts"}],[60,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default=[{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"hash",type:"bytes32"}],name:"setContent",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"content",outputs:[{name:"",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"interfaceID",type:"bytes4"}],name:"supportsInterface",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"pure",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"key",type:"string"},{name:"value",type:"string"}],name:"setText",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"},{name:"contentTypes",type:"uint256"}],name:"ABI",outputs:[{name:"contentType",type:"uint256"},{name:"data",type:"bytes"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"x",type:"bytes32"},{name:"y",type:"bytes32"}],name:"setPubkey",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"hash",type:"bytes"}],name:"setContenthash",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"addr",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"},{name:"key",type:"string"}],name:"text",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"contentType",type:"uint256"},{name:"data",type:"bytes"}],name:"setABI",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"name",type:"string"}],name:"setName",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"contenthash",outputs:[{name:"",type:"bytes"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"pubkey",outputs:[{name:"x",type:"bytes32"},{name:"y",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"addr",type:"address"}],name:"setAddr",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[{name:"ensAddr",type:"address"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"a",type:"address"}],name:"AddrChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"name",type:"string"}],name:"NameChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!0,name:"contentType",type:"uint256"}],name:"ABIChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"x",type:"bytes32"},{indexed:!1,name:"y",type:"bytes32"}],name:"PubkeyChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"indexedKey",type:"string"},{indexed:!1,name:"key",type:"string"}],name:"TextChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"hash",type:"bytes"}],name:"ContenthashChanged",type:"event"}]}}},{package:"$root$",file:"app/scripts/lib/ens-ipfs/contracts/resolver.js"}],[61,{"./contracts/registry":59,"./contracts/resolver":60,"@ensdomains/content-hash":376,"@metamask/ethjs-contract":1466,"@metamask/ethjs-query":1470,"eth-ens-namehash":3689},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=async function({provider:e,name:t}){const r=new s.default(e),u=n.default.hash(t),d=new i.default(r),h=Number.parseInt(await r.net_version(),10),f=function(e){switch(e){case 1:case 3:case 4:case 5:case 6:return"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e";default:return null}}(h);if(!f)throw new Error(`EnsIpfsResolver - no known ens-ipfs registry for chainId "${h}"`);const p=d(o.default).at(f),g=(await p.resolver(u))[0];if(l(g))throw new Error(`EnsIpfsResolver - no resolver found for name "${t}"`);const m=d(c.default).at(g),y=await m.supportsInterface("0xbc1c58d1"),b=await m.supportsInterface("0xd8389dc5");if(y[0]){const e=(await m.contenthash(u))[0];let t=a.default.decode(e);const r=a.default.getCodec(e);return"ipfs-ns"!==r&&"ipns-ns"!==r||(t=a.default.helpers.cidV0ToV1Base32(t)),{type:r,hash:t}}if(b[0]){const e=(await m.content(u))[0];if(l(e))throw new Error(`EnsIpfsResolver - no content ID found for name "${t}"`);return{type:"swarm-ns",hash:e.slice(2)}}throw new Error(`EnsIpfsResolver - the resolver for name "${t}" is not standard, it should either supports contenthash() or content()`)};var n=u(e("eth-ens-namehash")),s=u(e("@metamask/ethjs-query")),i=u(e("@metamask/ethjs-contract")),a=u(e("@ensdomains/content-hash")),o=u(e("./contracts/registry")),c=u(e("./contracts/resolver"));function u(e){return e&&e.__esModule?e:{default:e}}function l(e){return[undefined,null,"0x","0x0","0x0000000000000000000000000000000000000000000000000000000000000000"].includes(e)}}}},{package:"$root$",file:"app/scripts/lib/ens-ipfs/resolver.js"}],[62,{"../../../../shared/modules/fetch-with-timeout":4998,"./resolver":61,"base32-encode":3399,"base64-js":3400,"webextension-polyfill":4922},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function({provider:e,getCurrentChainId:t,getIpfsGateway:r,getUseAddressBarEnsResolution:a}){const c=l.map((e=>`*://*.${e}/*`));return i.default.webRequest.onErrorOccurred.addListener(d,{urls:c,types:["main_frame"]}),{remove(){i.default.webRequest.onErrorOccurred.removeListener(d)}};async function d(c){const{tabId:d,url:h}=c;if(-1===d||"0x1"!==t())return;const{hostname:f,pathname:p,search:g,hash:m}=new URL(h),y=f.split("."),b=y[y.length-1];l.includes(b)&&async function({tabId:t,name:c,pathname:l,search:d,fragment:h}){const f=r(),p=a(),g=`https://app.ens.domains/name/${c}`;p&&f&&await i.default.tabs.update(t,{url:"loading.html"});let m=g;0;try{const{type:t,hash:r}=await(0,o.default)({provider:e,name:c});if("ipfs-ns"===t||"ipns-ns"===t){if(""===f)return void(m=null);const e=`https://${r}.${t.slice(0,4)}.${f}${l}${d||""}${h||""}`;try{200===(await u(e,{method:"HEAD"})).status&&(m=e)}catch(e){console.warn(e)}}else if("swarm-ns"===t)m=`https://swarm-gateways.net/bzz:/${r}${l}${d||""}${h||""}`;else if("onion"===t||"onion3"===t)m=`http://${r}.onion${l}${d||""}${h||""}`;else if("zeronet"===t)m=`http://127.0.0.1:43110/${r}${l}${d||""}${h||""}`;else if("skynet-ns"===t){const e=r.padEnd(r.length+4-r.length%4,"="),t=s.default.toByteArray(e),i={padding:!1};m=`https://${(0,n.default)(t,"RFC4648-HEX",i).toLowerCase()}.siasky.net${l}${d||""}${h||""}`}}catch(e){console.warn(e)}finally{m&&(p||!p&&m!==g)&&await i.default.tabs.update(t,{url:m})}}({tabId:d,name:f,pathname:p,search:g,fragment:m})}};var n=c(e("base32-encode")),s=c(e("base64-js")),i=c(e("webextension-polyfill")),a=c(e("../../../../shared/modules/fetch-with-timeout")),o=c(e("./resolver"));function c(e){return e&&e.__esModule?e:{default:e}}const u=(0,a.default)(),l=["eth"]}}},{package:"$root$",file:"app/scripts/lib/ens-ipfs/setup.js"}],[625,{"./metamask-airgapped-keyring.cjs.development.js":626,"./metamask-airgapped-keyring.cjs.production.min.js":627},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=e("./metamask-airgapped-keyring.cjs.production.min.js")}}},{package:"@keystonehq/metamask-airgapped-keyring",file:"node_modules/@keystonehq/metamask-airgapped-keyring/dist/index.js"}],[626,{"@ethereumjs/tx":438,"@keystonehq/base-eth-keyring":594,"@keystonehq/bc-ur-registry-eth":598,"@metamask/obs-store":632,buffer:3497,events:3786,rlp:4723,uuid:4873},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0});var n,s=e("@keystonehq/base-eth-keyring"),i=e("events"),a=e("@metamask/obs-store"),o=e("@keystonehq/bc-ur-registry-eth"),c=e("uuid"),u=e("@ethereumjs/tx"),l=(n=e("rlp"))&&"object"==typeof n&&"default"in n?n.default:n;class d extends i.EventEmitter{constructor(){if(super(),this.cleanSyncListeners=()=>{this.removeAllListeners("keystone-sync_success-hdkey"),this.removeAllListeners("keystone-sync_success-account"),this.removeAllListeners("keystone-sync_cancel")},this.cleanSignListeners=e=>{this.removeAllListeners(`${e}-signed`),this.removeAllListeners(`${e}-canceled`)},this.readCryptoHDKeyOrCryptoAccount=()=>new Promise(((e,r)=>{this.memStore.updateState({sync:{reading:!0}}),this.on("keystone-sync_success-hdkey",(r=>{const n=o.CryptoHDKey.fromCBOR(t.from(r,"hex"));this.resetState(),e(n)})),this.on("keystone-sync_success-account",(r=>{const n=o.CryptoAccount.fromCBOR(t.from(r,"hex"));this.resetState(),e(n)})),this.on("keystone-sync_cancel",(()=>{this.resetState(),r(new Error("KeystoneError#sync_cancel. Sync process canceled, please retry"))}))})),this.submitCryptoHDKey=e=>{this.emit("keystone-sync_success-hdkey",e)},this.submitCryptoAccount=e=>{this.emit("keystone-sync_success-account",e)},this.cancelSync=()=>{this.emit("keystone-sync_cancel")},this.requestSignature=(e,r,n)=>new Promise(((s,i)=>{const a=e.toUR(),u=e.getRequestId(),l=c.stringify(u),d={requestId:l,payload:{type:a.type,cbor:a.cbor.toString("hex")},title:r,description:n};this.memStore.updateState({sign:{request:d}}),this.once(`${l}-signed`,(e=>{const r=o.ETHSignature.fromCBOR(t.from(e,"hex"));this.resetState(),s(r)})),this.once(`${l}-canceled`,(()=>{this.resetState(),i(new Error("KeystoneError#Tx_canceled. Signing canceled, please retry"))}))})),this.submitSignature=(e,t)=>{this.emit(`${e}-signed`,t)},this.cancelRequestSignature=()=>{const e=this.memStore.getState().sign.request;if(e){const{requestId:t}=e;this.memStore.updateState({sign:{}}),this.emit(`${t}-canceled`)}},this.reset=()=>{this.cleanSyncListeners();const e=this.memStore.getState().sign.request;if(e){const{requestId:t}=e;this.cleanSignListeners(t)}this.resetState()},this.resetState=()=>{this.memStore.updateState({sync:{reading:!1},sign:{}})},d.instance)return d.instance;this.memStore=new a.ObservableStore({sync:{reading:!1},sign:{},_version:1}),d.instance=this}}class h extends s.BaseKeyring{constructor(e){if(super(e),this.getInteraction=()=>new d,this.resetStore=()=>{this.getInteraction().reset()},this.getMemStore=()=>this.getInteraction().memStore,this.removeAccount=e=>{if(!this.accounts.map((e=>e.toLowerCase())).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter((t=>t.toLowerCase()!==e.toLowerCase()))},this.forgetDevice=()=>{this.page=0,this.perPage=5,this.accounts=[],this.currentAccount=0,this.name="QR Hardware",this.initialized=!1,this.xfp="",this.xpub="",this.hdPath="",this.indexes={},this.hdk=undefined,this.paths={}},this.submitCryptoHDKey=this.getInteraction().submitCryptoHDKey,this.submitCryptoAccount=this.getInteraction().submitCryptoAccount,this.submitSignature=this.getInteraction().submitSignature,this.cancelSync=this.getInteraction().cancelSync,this.cancelSignRequest=this.getInteraction().cancelRequestSignature,h.instance)return h.instance.deserialize(e),h.instance;h.instance=this}async signTransaction(e,t){const r=0===t.type?o.DataType.transaction:o.DataType.typedTransaction;let n;n=0===t.type?l.encode(t.getMessageToSign(!1)):t.getMessageToSign(!1);const s=await this._pathFromAddress(e),i=t.common.chainId(),a=c.v4(),d=o.EthSignRequest.constructETHRequest(n,r,s,this.xfp,a,i,e),{r:h,s:f,v:p}=await this.requestSignature(a,d,"Scan with your Keystone",'After your Keystone has signed the transaction, click on "Scan Keystone" to receive the signature'),g=t.toJSON();g.v=p,g.s=f,g.r=h,g.type=t.type;return u.TransactionFactory.fromTxData(g,{common:t.common})}}h.type=s.BaseKeyring.type,r.MetaMaskKeyring=h}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@keystonehq/metamask-airgapped-keyring",file:"node_modules/@keystonehq/metamask-airgapped-keyring/dist/metamask-airgapped-keyring.cjs.development.js"}],[627,{"@ethereumjs/tx":438,"@keystonehq/base-eth-keyring":594,"@keystonehq/bc-ur-registry-eth":598,"@metamask/obs-store":632,buffer:3497,events:3786,rlp:4723,uuid:4873},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0});var n,s=e("@keystonehq/base-eth-keyring"),i=e("events"),a=e("@metamask/obs-store"),o=e("@keystonehq/bc-ur-registry-eth"),c=e("uuid"),u=e("@ethereumjs/tx"),l=(n=e("rlp"))&&"object"==typeof n&&"default"in n?n.default:n;class d extends i.EventEmitter{constructor(){if(super(),this.cleanSyncListeners=()=>{this.removeAllListeners("keystone-sync_success-hdkey"),this.removeAllListeners("keystone-sync_success-account"),this.removeAllListeners("keystone-sync_cancel")},this.cleanSignListeners=e=>{this.removeAllListeners(e+"-signed"),this.removeAllListeners(e+"-canceled")},this.readCryptoHDKeyOrCryptoAccount=()=>new Promise(((e,r)=>{this.memStore.updateState({sync:{reading:!0}}),this.on("keystone-sync_success-hdkey",(r=>{const n=o.CryptoHDKey.fromCBOR(t.from(r,"hex"));this.resetState(),e(n)})),this.on("keystone-sync_success-account",(r=>{const n=o.CryptoAccount.fromCBOR(t.from(r,"hex"));this.resetState(),e(n)})),this.on("keystone-sync_cancel",(()=>{this.resetState(),r(new Error("KeystoneError#sync_cancel. Sync process canceled, please retry"))}))})),this.submitCryptoHDKey=e=>{this.emit("keystone-sync_success-hdkey",e)},this.submitCryptoAccount=e=>{this.emit("keystone-sync_success-account",e)},this.cancelSync=()=>{this.emit("keystone-sync_cancel")},this.requestSignature=(e,r,n)=>new Promise(((s,i)=>{const a=e.toUR(),u=e.getRequestId(),l=c.stringify(u),d={requestId:l,payload:{type:a.type,cbor:a.cbor.toString("hex")},title:r,description:n};this.memStore.updateState({sign:{request:d}}),this.once(l+"-signed",(e=>{const r=o.ETHSignature.fromCBOR(t.from(e,"hex"));this.resetState(),s(r)})),this.once(l+"-canceled",(()=>{this.resetState(),i(new Error("KeystoneError#Tx_canceled. Signing canceled, please retry"))}))})),this.submitSignature=(e,t)=>{this.emit(e+"-signed",t)},this.cancelRequestSignature=()=>{const e=this.memStore.getState().sign.request;if(e){const{requestId:t}=e;this.memStore.updateState({sign:{}}),this.emit(t+"-canceled")}},this.reset=()=>{this.cleanSyncListeners();const e=this.memStore.getState().sign.request;if(e){const{requestId:t}=e;this.cleanSignListeners(t)}this.resetState()},this.resetState=()=>{this.memStore.updateState({sync:{reading:!1},sign:{}})},d.instance)return d.instance;this.memStore=new a.ObservableStore({sync:{reading:!1},sign:{},_version:1}),d.instance=this}}class h extends s.BaseKeyring{constructor(e){if(super(e),this.getInteraction=()=>new d,this.resetStore=()=>{this.getInteraction().reset()},this.getMemStore=()=>this.getInteraction().memStore,this.removeAccount=e=>{if(!this.accounts.map((e=>e.toLowerCase())).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter((t=>t.toLowerCase()!==e.toLowerCase()))},this.forgetDevice=()=>{this.page=0,this.perPage=5,this.accounts=[],this.currentAccount=0,this.name="QR Hardware",this.initialized=!1,this.xfp="",this.xpub="",this.hdPath="",this.indexes={},this.hdk=void 0,this.paths={}},this.submitCryptoHDKey=this.getInteraction().submitCryptoHDKey,this.submitCryptoAccount=this.getInteraction().submitCryptoAccount,this.submitSignature=this.getInteraction().submitSignature,this.cancelSync=this.getInteraction().cancelSync,this.cancelSignRequest=this.getInteraction().cancelRequestSignature,h.instance)return h.instance.deserialize(e),h.instance;h.instance=this}async signTransaction(e,t){const r=0===t.type?o.DataType.transaction:o.DataType.typedTransaction;let n;n=0===t.type?l.encode(t.getMessageToSign(!1)):t.getMessageToSign(!1);const s=await this._pathFromAddress(e),i=t.common.chainId(),a=c.v4(),d=o.EthSignRequest.constructETHRequest(n,r,s,this.xfp,a,i,e),{r:h,s:f,v:p}=await this.requestSignature(a,d,"Scan with your Keystone",'After your Keystone has signed the transaction, click on "Scan Keystone" to receive the signature'),g=t.toJSON();return g.v=p,g.s=f,g.r=h,g.type=t.type,u.TransactionFactory.fromTxData(g,{common:t.common})}}h.type=s.BaseKeyring.type,r.MetaMaskKeyring=h}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@keystonehq/metamask-airgapped-keyring",file:"node_modules/@keystonehq/metamask-airgapped-keyring/dist/metamask-airgapped-keyring.cjs.production.min.js"}],[628,{"./ObservableStore":630},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ComposedStore=void 0;const n=e("./ObservableStore");class s extends n.ObservableStore{constructor(e){super({}),this._children=e||{},Object.keys(this._children).forEach((e=>{const t=this._children[e];this._addChild(e,t)}))}_addChild(e,t){const r=t=>{const r=this.getState();r[e]=t,this.putState(r)};t.subscribe(r),r(t.getState())}}r.ComposedStore=s}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/@metamask/obs-store/dist/ComposedStore.js"}],[629,{"./ObservableStore":630},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.MergedStore=void 0;const n=e("./ObservableStore");class s extends n.ObservableStore{constructor(e=[]){super({}),this._children=e,e.forEach((e=>this._addChild(e))),this._updateWholeState()}_addChild(e){e.subscribe((()=>this._updateWholeState()))}_updateWholeState(){const e=this._children.map((e=>e.getState())),t=Object.assign({},...e);this.putState(t)}}r.MergedStore=s}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/@metamask/obs-store/dist/MergedStore.js"}],[630,{"@metamask/safe-event-emitter":634},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.ObservableStore=void 0;const s=n(e("@metamask/safe-event-emitter"));class i extends s.default{constructor(e){super(),this._state=e||{}}getState(){return this._getState()}putState(e){this._putState(e),this.emit("update",e)}updateState(e){if(e&&"object"==typeof e){const t=this.getState();this.putState(Object.assign(Object.assign({},t),e))}else this.putState(e)}subscribe(e){this.on("update",e)}unsubscribe(e){this.removeListener("update",e)}_getState(){return this._state}_putState(e){this._state=e}}r.ObservableStore=i}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/@metamask/obs-store/dist/ObservableStore.js"}],[631,{stream:4798},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.storeAsStream=void 0;const n=e("stream");class s extends n.Duplex{constructor(e){super({objectMode:!0}),this.resume(),this.handler=e=>this.push(e),this.obsStore=e,this.obsStore.subscribe(this.handler)}pipe(e,t){const r=super.pipe(e,t);return e.write(this.obsStore.getState()),r}_write(e,t,r){this.obsStore.putState(e),r()}_read(e){return undefined}_destroy(e,t){this.obsStore.unsubscribe(this.handler),super._destroy(e,t)}}r.storeAsStream=function(e){return new s(e)}}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/@metamask/obs-store/dist/asStream.js"}],[632,{"./ComposedStore":628,"./MergedStore":629,"./ObservableStore":630,"./asStream":631,"./transform":633},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./asStream"),r),s(e("./ComposedStore"),r),s(e("./MergedStore"),r),s(e("./ObservableStore"),r),s(e("./transform"),r)}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/@metamask/obs-store/dist/index.js"}],[633,{through2:647},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.storeTransformStream=void 0;const n=e("through2");r.storeTransformStream=function(e){return n.obj(((t,r,n)=>{try{return n(null,e(t)),undefined}catch(e){return n(e),undefined}}))}}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/@metamask/obs-store/dist/transform.js"}],[634,{events:3786},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});const n=e("events");function s(e,t,r){try{Reflect.apply(e,t,r)}catch(e){setTimeout((()=>{throw e}))}}class i extends n.EventEmitter{emit(e,...t){let r="error"===e;const n=this._events;if(n!==undefined)r=r&&n.error===undefined;else if(!r)return!1;if(r){let e;if(t.length>0&&([e]=t),e instanceof Error)throw e;const r=new Error("Unhandled error."+(e?` (${e.message})`:""));throw r.context=e,r}const i=n[e];if(i===undefined)return!1;if("function"==typeof i)s(i,this,t);else{const e=i.length,r=function(e){const t=e.length,r=new Array(t);for(let n=0;n<t;n+=1)r[n]=e[n];return r}(i);for(let n=0;n<e;n+=1)s(r[n],this,t)}return!0}}r.default=i}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store>@metamask/safe-event-emitter",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/@metamask/safe-event-emitter/index.js"}],[635,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store>through2>readable-stream>isarray",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/isarray/index.js"}],[636,{"./_stream_readable":638,"./_stream_writable":640,"core-util-is":3559,inherits:4099,"process-nextick-args":4435},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("process-nextick-args"),s=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};t.exports=d;var i=Object.create(e("core-util-is"));i.inherits=e("inherits");var a=e("./_stream_readable"),o=e("./_stream_writable");i.inherits(d,a);for(var c=s(o.prototype),u=0;u<c.length;u++){var l=c[u];d.prototype[l]||(d.prototype[l]=o.prototype[l])}function d(e){if(!(this instanceof d))return new d(e);a.call(this,e),o.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",h)}function h(){this.allowHalfOpen||this._writableState.ended||n.nextTick(f,this)}function f(e){e.end()}Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(d.prototype,"destroyed",{get:function(){return this._readableState!==undefined&&this._writableState!==undefined&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){this._readableState!==undefined&&this._writableState!==undefined&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),d.prototype._destroy=function(e,t){this.push(null),this.end(),n.nextTick(t,e)}}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store>through2>readable-stream",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/readable-stream/lib/_stream_duplex.js"}],[637,{"./_stream_transform":639,"core-util-is":3559,inherits:4099},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=i;var n=e("./_stream_transform"),s=Object.create(e("core-util-is"));function i(e){if(!(this instanceof i))return new i(e);n.call(this,e)}s.inherits=e("inherits"),s.inherits(i,n),i.prototype._transform=function(e,t,r){r(null,e)}}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store>through2>readable-stream",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/readable-stream/lib/_stream_passthrough.js"}],[638,{"./_stream_duplex":636,"./internal/streams/BufferList":641,"./internal/streams/destroy":642,"./internal/streams/stream":643,_process:4436,"core-util-is":3559,events:3786,inherits:4099,isarray:635,"process-nextick-args":4435,"safe-buffer":645,"string_decoder/":646,util:3462},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("process-nextick-args");t.exports=b;var s,i=e("isarray");b.ReadableState=y;e("events").EventEmitter;var a=function(e,t){return e.listeners(t).length},o=e("./internal/streams/stream"),c=e("safe-buffer").Buffer,u=global.Uint8Array||function(){};var l=Object.create(e("core-util-is"));l.inherits=e("inherits");var d=e("util"),h=void 0;h=d&&d.debuglog?d.debuglog("stream"):function(){};var f,p=e("./internal/streams/BufferList"),g=e("./internal/streams/destroy");l.inherits(b,o);var m=["error","close","destroy","pause","resume"];function y(t,r){t=t||{};var n=r instanceof(s=s||e("./_stream_duplex"));this.objectMode=!!t.objectMode,n&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var i=t.highWaterMark,a=t.readableHighWaterMark,o=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:n&&(a||0===a)?a:o,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(f||(f=e("string_decoder/").StringDecoder),this.decoder=new f(t.encoding),this.encoding=t.encoding)}function b(t){if(s=s||e("./_stream_duplex"),!(this instanceof b))return new b(t);this._readableState=new y(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),o.call(this)}function _(e,t,r,n,s){var i,a=e._readableState;null===t?(a.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,S(e)}(e,a)):(s||(i=function(e,t){var r;n=t,c.isBuffer(n)||n instanceof u||"string"==typeof t||t===undefined||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk"));var n;return r}(a,t)),i?e.emit("error",i):a.objectMode||t&&t.length>0?("string"==typeof t||a.objectMode||Object.getPrototypeOf(t)===c.prototype||(t=function(e){return c.from(e)}(t)),n?a.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):w(e,a,t,!0):a.ended?e.emit("error",new Error("stream.push() after EOF")):(a.reading=!1,a.decoder&&!r?(t=a.decoder.write(t),a.objectMode||0!==t.length?w(e,a,t,!1):T(e,a)):w(e,a,t,!1))):n||(a.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(a)}function w(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&S(e)),T(e,t)}Object.defineProperty(b.prototype,"destroyed",{get:function(){return this._readableState!==undefined&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),b.prototype.destroy=g.destroy,b.prototype._undestroy=g.undestroy,b.prototype._destroy=function(e,t){this.push(null),t(e)},b.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=c.from(e,t),t=""),r=!0),_(this,e,t,!1,r)},b.prototype.unshift=function(e){return _(this,e,null,!0,!1)},b.prototype.isPaused=function(){return!1===this._readableState.flowing},b.prototype.setEncoding=function(t){return f||(f=e("string_decoder/").StringDecoder),this._readableState.decoder=new f(t),this._readableState.encoding=t,this};var v=8388608;function k(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=v?e=v:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function S(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(h("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?n.nextTick(E,e):E(e))}function E(e){h("emit readable"),e.emit("readable"),M(e)}function T(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(A,e,t))}function A(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(h("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function C(e){h("readable nexttick read 0"),e.read(0)}function P(e,t){t.reading||(h("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),M(e),t.flowing&&!t.reading&&e.read(0)}function M(e){var t=e._readableState;for(h("flow",t.flowing);t.flowing&&null!==e.read(););}function O(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=function(e,t,r){var n;e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?function(e,t){var r=t.head,n=1,s=r.data;e-=s.length;for(;r=r.next;){var i=r.data,a=e>i.length?i.length:e;if(a===i.length?s+=i:s+=i.slice(0,e),0===(e-=a)){a===i.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=i.slice(a));break}++n}return t.length-=n,s}(e,t):function(e,t){var r=c.allocUnsafe(e),n=t.head,s=1;n.data.copy(r),e-=n.data.length;for(;n=n.next;){var i=n.data,a=e>i.length?i.length:e;if(i.copy(r,r.length-e,0,a),0===(e-=a)){a===i.length?(++s,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=i.slice(a));break}++s}return t.length-=s,r}(e,t);return n}(e,t.buffer,t.decoder),r);var r}function I(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,n.nextTick(x,t,e))}function x(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function N(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}b.prototype.read=function(e){h("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return h("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?I(this):S(this),null;if(0===(e=k(e,t))&&t.ended)return 0===t.length&&I(this),null;var n,s=t.needReadable;return h("need readable",s),(0===t.length||t.length-e<t.highWaterMark)&&h("length less than watermark",s=!0),t.ended||t.reading?h("reading or ended",s=!1):s&&(h("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=k(r,t))),null===(n=e>0?O(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&I(this)),null!==n&&this.emit("data",n),n},b.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},b.prototype.pipe=function(e,t){var s=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=e;break;case 1:o.pipes=[o.pipes,e];break;default:o.pipes.push(e)}o.pipesCount+=1,h("pipe count=%d opts=%j",o.pipesCount,t);var c=(!t||!1!==t.end)&&e!==r.stdout&&e!==r.stderr?l:_;function u(t,r){h("onunpipe"),t===s&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,h("cleanup"),e.removeListener("close",y),e.removeListener("finish",b),e.removeListener("drain",d),e.removeListener("error",m),e.removeListener("unpipe",u),s.removeListener("end",l),s.removeListener("end",_),s.removeListener("data",g),f=!0,!o.awaitDrain||e._writableState&&!e._writableState.needDrain||d())}function l(){h("onend"),e.end()}o.endEmitted?n.nextTick(c):s.once("end",c),e.on("unpipe",u);var d=function(e){return function(){var t=e._readableState;h("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&a(e,"data")&&(t.flowing=!0,M(e))}}(s);e.on("drain",d);var f=!1;var p=!1;function g(t){h("ondata"),p=!1,!1!==e.write(t)||p||((1===o.pipesCount&&o.pipes===e||o.pipesCount>1&&-1!==N(o.pipes,e))&&!f&&(h("false write response, pause",s._readableState.awaitDrain),s._readableState.awaitDrain++,p=!0),s.pause())}function m(t){h("onerror",t),_(),e.removeListener("error",m),0===a(e,"error")&&e.emit("error",t)}function y(){e.removeListener("finish",b),_()}function b(){h("onfinish"),e.removeListener("close",y),_()}function _(){h("unpipe"),s.unpipe(e)}return s.on("data",g),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?i(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",m),e.once("close",y),e.once("finish",b),e.emit("pipe",s),o.flowing||(h("pipe resume"),s.resume()),e},b.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,s=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<s;i++)n[i].emit("unpipe",this,r);return this}var a=N(t.pipes,e);return-1===a||(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},b.prototype.on=function(e,t){var r=o.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var s=this._readableState;s.endEmitted||s.readableListening||(s.readableListening=s.needReadable=!0,s.emittedReadable=!1,s.reading?s.length&&S(this):n.nextTick(C,this))}return r},b.prototype.addListener=b.prototype.on,b.prototype.resume=function(){var e=this._readableState;return e.flowing||(h("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(P,e,t))}(this,e)),this},b.prototype.pause=function(){return h("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(h("pause"),this._readableState.flowing=!1,this.emit("pause")),this},b.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var s in e.on("end",(function(){if(h("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(s){(h("wrapped data"),r.decoder&&(s=r.decoder.write(s)),!r.objectMode||null!==s&&s!==undefined)&&((r.objectMode||s&&s.length)&&(t.push(s)||(n=!0,e.pause())))})),e)this[s]===undefined&&"function"==typeof e[s]&&(this[s]=function(t){return function(){return e[t].apply(e,arguments)}}(s));for(var i=0;i<m.length;i++)e.on(m[i],this.emit.bind(this,m[i]));return this._read=function(t){h("wrapped _read",t),n&&(n=!1,e.resume())},this},Object.defineProperty(b.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),b._fromList=O}).call(this)}).call(this,e("_process"))}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store>through2>readable-stream",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/readable-stream/lib/_stream_readable.js"}],[639,{"./_stream_duplex":636,"core-util-is":3559,inherits:4099},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=a;var n=e("./_stream_duplex"),s=Object.create(e("core-util-is"));function i(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(!n)return this.emit("error",new Error("write callback called multiple times"));r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var s=this._readableState;s.reading=!1,(s.needReadable||s.length<s.highWaterMark)&&this._read(s.highWaterMark)}function a(e){if(!(this instanceof a))return new a(e);n.call(this,e),this._transformState={afterTransform:i.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",o)}function o(){var e=this;"function"==typeof this._flush?this._flush((function(t,r){c(e,t,r)})):c(this,null,null)}function c(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}s.inherits=e("inherits"),s.inherits(a,n),a.prototype.push=function(e,t){return this._transformState.needTransform=!1,n.prototype.push.call(this,e,t)},a.prototype._transform=function(e,t,r){throw new Error("_transform() is not implemented")},a.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var s=this._readableState;(n.needTransform||s.needReadable||s.length<s.highWaterMark)&&this._read(s.highWaterMark)}},a.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},a.prototype._destroy=function(e,t){var r=this;n.prototype._destroy.call(this,e,(function(e){t(e),r.emit("close")}))}}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store>through2>readable-stream",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/readable-stream/lib/_stream_transform.js"}],[640,{"./_stream_duplex":636,"./internal/streams/destroy":642,"./internal/streams/stream":643,_process:4436,"core-util-is":3559,inherits:4099,"process-nextick-args":4435,"safe-buffer":645,timers:4815,"util-deprecate":4869},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(r,n){(function(){var s=e("process-nextick-args");function i(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;e.entry=null;for(;n;){var s=n.callback;t.pendingcb--,s(r),n=n.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}t.exports=y;var a,o=!r.browser&&["v0.10","v0.9."].indexOf(r.version.slice(0,5))>-1?n:s.nextTick;y.WritableState=m;var c=Object.create(e("core-util-is"));c.inherits=e("inherits");var u={deprecate:e("util-deprecate")},l=e("./internal/streams/stream"),d=e("safe-buffer").Buffer,h=global.Uint8Array||function(){};var f,p=e("./internal/streams/destroy");function g(){}function m(t,r){a=a||e("./_stream_duplex"),t=t||{};var n=r instanceof a;this.objectMode=!!t.objectMode,n&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var c=t.highWaterMark,u=t.writableHighWaterMark,l=this.objectMode?16:16384;this.highWaterMark=c||0===c?c:n&&(u||0===u)?u:l,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var d=!1===t.decodeStrings;this.decodeStrings=!d,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,n=r.sync,i=r.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,n,i){--t.pendingcb,r?(s.nextTick(i,n),s.nextTick(S,e,t),e._writableState.errorEmitted=!0,e.emit("error",n)):(i(n),e._writableState.errorEmitted=!0,e.emit("error",n),S(e,t))}(e,r,n,t,i);else{var a=v(r);a||r.corked||r.bufferProcessing||!r.bufferedRequest||w(e,r),n?o(_,e,r,a,i):_(e,r,a,i)}}(r,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function y(t){if(a=a||e("./_stream_duplex"),!(f.call(y,this)||this instanceof a))return new y(t);this._writableState=new m(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),l.call(this)}function b(e,t,r,n,s,i,a){t.writelen=n,t.writecb=a,t.writing=!0,t.sync=!0,r?e._writev(s,t.onwrite):e._write(s,i,t.onwrite),t.sync=!1}function _(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),S(e,t)}function w(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,s=new Array(n),a=t.corkedRequestsFree;a.entry=r;for(var o=0,c=!0;r;)s[o]=r,r.isBuf||(c=!1),r=r.next,o+=1;s.allBuffers=c,b(e,t,!0,t.length,s,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new i(t),t.bufferedRequestCount=0}else{for(;r;){var u=r.chunk,l=r.encoding,d=r.callback;if(b(e,t,!1,t.objectMode?1:u.length,u,l,d),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function v(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function k(e,t){e._final((function(r){t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),S(e,t)}))}function S(e,t){var r=v(t);return r&&(!function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,s.nextTick(k,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),r}c.inherits(y,l),m.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(m.prototype,"buffer",{get:u.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(f=Function.prototype[Symbol.hasInstance],Object.defineProperty(y,Symbol.hasInstance,{value:function(e){return!!f.call(this,e)||this===y&&(e&&e._writableState instanceof m)}})):f=function(e){return e instanceof this},y.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},y.prototype.write=function(e,t,r){var n,i=this._writableState,a=!1,o=!i.objectMode&&(n=e,d.isBuffer(n)||n instanceof h);return o&&!d.isBuffer(e)&&(e=function(e){return d.from(e)}(e)),"function"==typeof t&&(r=t,t=null),o?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof r&&(r=g),i.ended?function(e,t){var r=new Error("write after end");e.emit("error",r),s.nextTick(t,r)}(this,r):(o||function(e,t,r,n){var i=!0,a=!1;return null===r?a=new TypeError("May not write null values to stream"):"string"==typeof r||r===undefined||t.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(e.emit("error",a),s.nextTick(n,a),i=!1),i}(this,i,e,r))&&(i.pendingcb++,a=function(e,t,r,n,s,i){if(!r){var a=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=d.from(t,r));return t}(t,n,s);n!==a&&(r=!0,s="buffer",n=a)}var o=t.objectMode?1:n.length;t.length+=o;var c=t.length<t.highWaterMark;c||(t.needDrain=!0);if(t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:s,isBuf:r,callback:i,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else b(e,t,!1,o,n,s,i);return c}(this,i,o,e,t,r)),a},y.prototype.cork=function(){this._writableState.corked++},y.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||w(this,e))},y.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(y.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),y.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))},y.prototype._writev=null,y.prototype.end=function(e,t,r){var n=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!==e&&e!==undefined&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||n.finished||function(e,t,r){t.ending=!0,S(e,t),r&&(t.finished?s.nextTick(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,n,r)},Object.defineProperty(y.prototype,"destroyed",{get:function(){return this._writableState!==undefined&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),y.prototype.destroy=p.destroy,y.prototype._undestroy=p.undestroy,y.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this)}).call(this,e("_process"),e("timers").setImmediate)}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store>through2>readable-stream",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/readable-stream/lib/_stream_writable.js"}],[641,{"safe-buffer":645,util:3462},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("safe-buffer").Buffer,s=e("util");t.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},e.prototype.concat=function(e){if(0===this.length)return n.alloc(0);if(1===this.length)return this.head.data;for(var t,r,s,i=n.allocUnsafe(e>>>0),a=this.head,o=0;a;)t=a.data,r=i,s=o,t.copy(r,s),o+=a.data.length,a=a.next;return i},e}(),s&&s.inspect&&s.inspect.custom&&(t.exports.prototype[s.inspect.custom]=function(){var e=s.inspect({length:this.length});return this.constructor.name+" "+e})}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store>through2>readable-stream",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/readable-stream/lib/internal/streams/BufferList.js"}],[642,{"process-nextick-args":4435},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("process-nextick-args");function s(e,t){e.emit("error",t)}t.exports={destroy:function(e,t){var r=this,i=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return i||a?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||n.nextTick(s,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?(n.nextTick(s,r,e),r._writableState&&(r._writableState.errorEmitted=!0)):t&&t(e)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store>through2>readable-stream",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/readable-stream/lib/internal/streams/destroy.js"}],[643,{events:3786},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=e("events").EventEmitter}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store>through2>readable-stream",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/readable-stream/lib/internal/streams/stream-browser.js"}],[644,{"./lib/_stream_duplex.js":636,"./lib/_stream_passthrough.js":637,"./lib/_stream_readable.js":638,"./lib/_stream_transform.js":639,"./lib/_stream_writable.js":640},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(r=t.exports=e("./lib/_stream_readable.js")).Stream=r,r.Readable=r,r.Writable=e("./lib/_stream_writable.js"),r.Duplex=e("./lib/_stream_duplex.js"),r.Transform=e("./lib/_stream_transform.js"),r.PassThrough=e("./lib/_stream_passthrough.js")}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store>through2>readable-stream",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/readable-stream/readable-browser.js"}],[645,{buffer:3497},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("buffer"),s=n.Buffer;function i(e,t){for(var r in e)t[r]=e[r]}function a(e,t,r){return s(e,t,r)}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?t.exports=n:(i(n,r),r.Buffer=a),i(s,a),a.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return s(e,t,r)},a.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=s(e);return t!==undefined?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return s(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store>through2>readable-stream>safe-buffer",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/safe-buffer/index.js"}],[646,{"safe-buffer":645},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("safe-buffer").Buffer,s=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function i(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(n.isEncoding===s||!s(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=c,this.end=u,t=4;break;case"utf8":this.fillLast=o,t=4;break;case"base64":this.text=l,this.end=d,t=3;break;default:return this.write=h,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function a(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function o(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"�"}}(this,e);return r!==undefined?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function c(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function u(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function l(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function d(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function h(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}r.StringDecoder=i,i.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if((t=this.fillLast(e))===undefined)return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},i.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t},i.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(n<r)return 0;var s=a(t[n]);if(s>=0)return s>0&&(e.lastNeed=s-1),s;if(--n<r||-2===s)return 0;if(s=a(t[n]),s>=0)return s>0&&(e.lastNeed=s-2),s;if(--n<r||-2===s)return 0;if(s=a(t[n]),s>=0)return s>0&&(2===s?s=0:e.lastNeed=s-3),s;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},i.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store>through2>readable-stream>string_decoder",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/string_decoder/lib/string_decoder.js"}],[647,{_process:4436,"readable-stream":644,util:4872,xtend:4928},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("readable-stream").Transform,s=e("util").inherits,i=e("xtend");function a(e){n.call(this,e),this._destroyed=!1}function o(e,t,r){r(null,e)}function c(e){return function(t,r,n){return"function"==typeof t&&(n=r,r=t,t={}),"function"!=typeof r&&(r=o),"function"!=typeof n&&(n=null),e(t,r,n)}}s(a,n),a.prototype.destroy=function(e){if(!this._destroyed){this._destroyed=!0;var t=this;r.nextTick((function(){e&&t.emit("error",e),t.emit("close")}))}},t.exports=c((function(e,t,r){var n=new a(e);return n._transform=t,r&&(n._flush=r),n})),t.exports.ctor=c((function(e,t,r){function n(t){if(!(this instanceof n))return new n(t);this.options=i(e,t),a.call(this,this.options)}return s(n,a),n.prototype._transform=t,r&&(n.prototype._flush=r),n})),t.exports.obj=c((function(e,t,r){var n=new a(i({objectMode:!0,highWaterMark:16},e));return n._transform=t,r&&(n._flush=r),n}))}).call(this)}).call(this,e("_process"))}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store>through2",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/through2/through2.js"}],[65,{lodash:4294},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return s((0,n.cloneDeep)(e),(e=>null===e?"null":typeof e))};var n=e("lodash");function s(e={},t){return Object.entries(e).forEach((([r,n])=>{e[r]="object"==typeof n&&null!==n?s(n,t):t(n)})),e}}}},{package:"$root$",file:"app/scripts/lib/getObjStructure.js"}],[66,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.hardwareKeyringBuilderFactory=function(e,t){const r=()=>new e({bridge:new t});return r.type=e.type,r}}}},{package:"$root$",file:"app/scripts/lib/hardware-keyring-builder-factory.ts"}],[69,{"../util":117,"json-rpc-engine":4138},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createPendingNonceMiddleware=function({getPendingNonce:e}){return(0,n.createAsyncMiddleware)((async(t,r,n)=>{const{method:s,params:i}=t;if("eth_getTransactionCount"!==s)return void n();const[a,o]=i;"pending"===o?r.result=await e(a,t.networkClientId):n()}))},r.createPendingTxMiddleware=function({getPendingTransactionByHash:e}){return(0,n.createAsyncMiddleware)((async(t,r,n)=>{const{method:i,params:a}=t;if("eth_getTransactionByHash"!==i)return void n();const[o]=a,c=e(o);c?r.result=(0,s.formatTxMetaForRpcResult)(c):n()}))};var n=e("json-rpc-engine"),s=e("../util")}}},{package:"$root$",file:"app/scripts/lib/middleware/pending.js"}],[70,{events:3786,loglevel:4300},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=i(e("events")),s=i(e("loglevel"));function i(e){return e&&e.__esModule?e:{default:e}}class a extends n.default{constructor(e={}){super();const t=e.migrations||[];this.migrations=t.sort(((e,t)=>e.version-t.version));const r=this.migrations.slice(-1)[0];this.defaultVersion=e.defaultVersion||r&&r.version||0}async migrateData(e=this.generateInitialState()){const t=this.migrations.filter((function(t){return t.version>e.meta.version}));for(const r of t)try{s.default.info(`Running migration ${r.version}...`);const t=await r.migrate(e);if(!t.data)throw new Error("Migrator - migration returned empty data");if(t.version!==undefined&&t.meta.version!==r.version)throw new Error("Migrator - Migration did not update version number correctly");e=t,s.default.info(`Migration ${r.version} complete`)}catch(t){const n=t.message;return t.message=`MetaMask Migration Error #${r.version}: ${n}`,this.emit("error",t),e}return e}generateInitialState(e){return{meta:{version:this.defaultVersion},data:e}}}r.default=a}}},{package:"$root$",file:"app/scripts/lib/migrator/index.js"}],[73,{"../../../shared/constants/notifications":4960,"../platforms/extension":263,"@metamask/safe-event-emitter":2014},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.NOTIFICATION_MANAGER_EVENTS=void 0;var n=a(e("@metamask/safe-event-emitter")),s=a(e("../platforms/extension")),i=e("../../../shared/constants/notifications");function a(e){return e&&e.__esModule?e:{default:e}}const o=r.NOTIFICATION_MANAGER_EVENTS={POPUP_CLOSED:"onPopupClosed"};class c extends n.default{constructor(){super(),this.platform=new s.default,this.platform.addOnRemovedListener(this._onWindowClosed.bind(this))}markAsAutomaticallyClosed(){this._popupAutomaticallyClosed=!0}async showPopup(e,t){this._popupId=t,this._setCurrentPopupId=e;const r=await this._getPopup(t);if(r)await this.platform.focusWindow(r.id);else{let e=0,t=0;try{const r=await this.platform.getLastFocusedWindow();t=r.top,e=Math.max(r.left+(r.width-i.NOTIFICATION_WIDTH),0)}catch(r){const{screenX:n,screenY:s,outerWidth:a}=window;t=Math.max(s,0),e=Math.max(n+(a-i.NOTIFICATION_WIDTH),0)}const r=await this.platform.openWindow({url:"notification.html",type:"popup",width:i.NOTIFICATION_WIDTH,height:i.NOTIFICATION_HEIGHT,left:e,top:t});r.left!==e&&"fullscreen"!==r.state&&await this.platform.updateWindowPosition(r.id,e,t),this._setCurrentPopupId(r.id),this._popupId=r.id}}_onWindowClosed(e){e===this._popupId&&(this._setCurrentPopupId(undefined),this._popupId=undefined,this.emit(o.POPUP_CLOSED,{automaticallyClosed:this._popupAutomaticallyClosed}),this._popupAutomaticallyClosed=undefined)}async _getPopup(){const e=await this.platform.getAllWindows();return this._getPopupIn(e)}_getPopupIn(e){return e?e.find((e=>e&&"popup"===e.type&&e.id===this._popupId)):null}}r.default=c}}},{package:"$root$",file:"app/scripts/lib/notification-manager.js"}],[74,{"../../../../shared/constants/offscreen-communication":4961,"eth-lattice-keyring":3690},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.LatticeKeyringOffscreen=void 0;var n,s=(n=e("eth-lattice-keyring"))&&n.__esModule?n:{default:n},i=e("../../../../shared/constants/offscreen-communication");class a extends s.default{constructor(e={}){super(e)}async _getCreds(){try{const e=this.appName?this.appName:"Unknown",t=`${i.KnownOrigins.lattice}?keyring=${e}&forceLogin=true`;return await new Promise(((e,r)=>{chrome.runtime.sendMessage({target:i.OffscreenCommunicationTarget.latticeOffscreen,params:{url:t}},(t=>{t.error&&r(t.error),e(t.result)}))}))}catch(e){throw new Error(e)}}}r.LatticeKeyringOffscreen=a,function(e,t,r){(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(r!==undefined){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(a,"type",void 0),a.type=s.default.type}}},{package:"$root$",file:"app/scripts/lib/offscreen-bridge/lattice-offscreen-keyring.ts"}],[75,{"../../../../shared/constants/offscreen-communication":4961},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.LedgerOffscreenBridge=void 0;var n=e("../../../../shared/constants/offscreen-communication");function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(r!==undefined){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.LedgerOffscreenBridge=class{constructor(){s(this,"isDeviceConnected",!1)}init(){return chrome.runtime.onMessage.addListener((e=>{e.target===n.OffscreenCommunicationTarget.extension&&e.event===n.OffscreenCommunicationEvents.ledgerDeviceConnect&&(this.isDeviceConnected=!0)})),Promise.resolve()}destroy(){return Promise.resolve()}attemptMakeApp(){return new Promise(((e,t)=>{chrome.runtime.sendMessage({target:n.OffscreenCommunicationTarget.ledgerOffscreen,action:n.LedgerAction.makeApp},(r=>{r.success?e(!0):r.error?t(r.error):t(new Error("Unknown error occurred"))}))}))}updateTransportMethod(e){return new Promise(((t,r)=>{chrome.runtime.sendMessage({target:n.OffscreenCommunicationTarget.ledgerOffscreen,action:n.LedgerAction.updateTransport,params:{transportType:e}},(e=>{e.success?t(!0):r(new Error("Ledger transport could not be updated"))}))}))}getPublicKey(e){return new Promise(((t,r)=>{chrome.runtime.sendMessage({target:n.OffscreenCommunicationTarget.ledgerOffscreen,action:n.LedgerAction.getPublicKey,params:e},(e=>{e.success?t(e.payload):r(e.payload.error)}))}))}deviceSignTransaction(e){return new Promise(((t,r)=>{chrome.runtime.sendMessage({target:n.OffscreenCommunicationTarget.ledgerOffscreen,action:n.LedgerAction.signTransaction,params:e},(e=>{e.success?t(e.payload):r(e.payload.error)}))}))}deviceSignMessage(e){return new Promise(((t,r)=>{chrome.runtime.sendMessage({target:n.OffscreenCommunicationTarget.ledgerOffscreen,action:n.LedgerAction.signPersonalMessage,params:e},(e=>{e.success?t(e.payload):r(e.payload.error)}))}))}deviceSignTypedData(e){return new Promise(((t,r)=>{chrome.runtime.sendMessage({target:n.OffscreenCommunicationTarget.ledgerOffscreen,action:n.LedgerAction.signTypedData,params:e},(e=>{e.success?t(e.payload):r(e.payload.error)}))}))}}}}},{package:"$root$",file:"app/scripts/lib/offscreen-bridge/ledger-offscreen-bridge.ts"}],[76,{"../../../../shared/constants/offscreen-communication":4961},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.TrezorOffscreenBridge=void 0;var n=e("../../../../shared/constants/offscreen-communication");function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(r!==undefined){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.TrezorOffscreenBridge=class{constructor(){s(this,"model",void 0)}init(e){return chrome.runtime.onMessage.addListener((e=>{e.target===n.OffscreenCommunicationTarget.extension&&e.event===n.OffscreenCommunicationEvents.trezorDeviceConnect&&(this.model=e.payload)})),new Promise((t=>{chrome.runtime.sendMessage({target:n.OffscreenCommunicationTarget.trezorOffscreen,action:n.TrezorAction.init,params:e},(()=>{t()}))}))}dispose(){return new Promise((e=>{chrome.runtime.sendMessage({target:n.OffscreenCommunicationTarget.trezorOffscreen,action:n.TrezorAction.dispose},(()=>{e()}))}))}getPublicKey(e){return new Promise((t=>{chrome.runtime.sendMessage({target:n.OffscreenCommunicationTarget.trezorOffscreen,action:n.TrezorAction.getPublicKey,params:e},(e=>{t(e)}))}))}ethereumSignTransaction(e){return new Promise((t=>{chrome.runtime.sendMessage({target:n.OffscreenCommunicationTarget.trezorOffscreen,action:n.TrezorAction.signTransaction,params:e},(e=>{t(e)}))}))}ethereumSignMessage(e){return new Promise((t=>{chrome.runtime.sendMessage({target:n.OffscreenCommunicationTarget.trezorOffscreen,action:n.TrezorAction.signMessage,params:e},(e=>{t(e)}))}))}ethereumSignTypedData(e){return new Promise((t=>{chrome.runtime.sendMessage({target:n.OffscreenCommunicationTarget.trezorOffscreen,action:n.TrezorAction.signTypedData,params:e},(e=>{t(e)}))}))}}}}},{package:"$root$",file:"app/scripts/lib/offscreen-bridge/trezor-offscreen-bridge.ts"}],[77,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){function n(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(r!==undefined){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(r,"__esModule",{value:!0}),r.IndexedDBPPOMStorage=void 0;const i=async(e,t,r)=>{const n=await crypto.subtle.digest("SHA-256",t);if(Array.from(new Uint8Array(n)).map((e=>e.toString(16).padStart(2,"0"))).join("")!==r)throw new Error(`Checksum mismatch for key ${e}`)};var a=new WeakSet;function o(e){return new Promise(((t,r)=>{const n=indexedDB.open(this.storeName,this.dbVersion);n.onerror=e=>{var t;r(new Error(`Failed to open database ${this.storeName}: ${null===(t=e.target)||void 0===t?void 0:t.error}`))},n.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(this.storeName)||t.createObjectStore(this.storeName,{keyPath:["name","chainId"]})},n.onsuccess=r=>{const n=r.target.result.transaction([this.storeName],e).objectStore(this.storeName);t(n)}}))}r.IndexedDBPPOMStorage=class{constructor(e,t){n(this,a),s(this,"storeName",void 0),s(this,"dbVersion",void 0),this.storeName=e,this.dbVersion=t}async objectStoreAction(e,t,r="readonly"){return new Promise(((n,s)=>{(function(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r})(this,a,o).call(this,r).then((r=>{const i=r[e](t);i.onsuccess=async e=>{n(e)},i.onerror=t=>{var r;s(new Error(`Error in indexDB operation ${e}: ${null===(r=t.target)||void 0===r?void 0:r.error}`))}})).catch((e=>{s(e)}))}))}async read(e,t){var r;const n=null===(r=(await this.objectStoreAction("get",[e.name,e.chainId])).target)||void 0===r||null===(r=r.result)||void 0===r?void 0:r.data;return await i(e,n,t),n}async write(e,t,r){await i(e,t,r),await this.objectStoreAction("put",{...e,data:t},"readwrite")}async delete(e){await this.objectStoreAction("delete",[e.name,e.chainId],"readwrite")}async dir(){var e;return null===(e=(await this.objectStoreAction("getAllKeys")).target)||void 0===e?void 0:e.result.map((([e,t])=>({name:e,chainId:t})))}}}}},{package:"$root$",file:"app/scripts/lib/ppom/indexed-db-backend.ts"}],[78,{"../../../../shared/constants/app":4943,"../../../../shared/constants/security-provider":4965,"../../../../shared/constants/transaction":4973,"../../../../shared/lib/trace":4985,"../../../../ui/ducks/metamask/metamask":5867,"./ppom-util":79,"@metamask/controller-utils":1231},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createPPOMMiddleware=function(e,t,r,d,h,f){return async(p,g,m)=>{try{var y;const g=null===(y=t.store.getState())||void 0===y?void 0:y.securityAlertsEnabled,{chainId:m}=(0,o.getProviderConfig)({metamask:r.state}),b=await(0,u.isChainSupported)(m);if(!g||!l.includes(p.method)||!b)return;const _=p.params[0];if("string"==typeof _){const{isSIWEMessage:e}=(0,n.detectSIWE)({data:_});if(e)return}else if(p.method===s.MESSAGE_TYPE.ETH_SEND_TRANSACTION){const{to:e}=_??{},t=h.listAccounts();if(t.some((({address:t})=>(null==t?void 0:t.toLowerCase())===(null==e?void 0:e.toLowerCase()))))return}const w=(0,u.generateSecurityAlertId)();(0,c.trace)({name:c.TraceName.PPOMValidation,parentContext:p.traceContext},(()=>(0,u.validateRequestWithPPOM)({ppomController:e,request:p,securityAlertId:w,chainId:m}).then((e=>{f(p.method,w,e)}))));const v={...a.LOADING_SECURITY_ALERT_RESPONSE,securityAlertId:w};i.SIGNING_METHODS.includes(p.method)&&d.addSignatureSecurityAlertResponse(v),p.securityAlertResponse=v}catch(e){p.securityAlertResponse=(0,u.handlePPOMError)(e,"Error createPPOMMiddleware: ")}finally{m()}}};var n=e("@metamask/controller-utils"),s=e("../../../../shared/constants/app"),i=e("../../../../shared/constants/transaction"),a=e("../../../../shared/constants/security-provider"),o=e("../../../../ui/ducks/metamask/metamask"),c=e("../../../../shared/lib/trace"),u=e("./ppom-util");const l=Object.freeze(["eth_sendRawTransaction","eth_sendTransaction",...i.SIGNING_METHODS])}}},{package:"$root$",file:"app/scripts/lib/ppom/ppom-middleware.ts"}],[79,{"../../../../shared/constants/security-provider":4965,"../../../../shared/constants/transaction":4973,"./security-alerts-api":81,"@metamask/transaction-controller":2624,uuid:4873},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.generateSecurityAlertId=function(){return(0,s.v4)()},r.handlePPOMError=d,r.isChainSupported=async function(e){let t=i.SECURITY_PROVIDER_SUPPORTED_CHAIN_IDS;try{(0,o.isSecurityAlertsAPIEnabled)()&&(t=await(0,o.getSecurityAlertsAPISupportedChainIds)())}catch(e){d(e,"Error fetching supported chains from security alerts API")}return t.includes(e)},r.updateSecurityAlertResponse=async function({appStateController:e,method:t,securityAlertId:r,securityAlertResponse:n,signatureController:s,transactionController:i}){const o=a.SIGNING_METHODS.includes(t),c=await async function(e,t,r,n){const s=a.SIGNING_METHODS.includes(t);for(;;){let t;if(t=s?Object.values(r.messages).find((t=>{var r;return(null===(r=t.securityAlertResponse)||void 0===r?void 0:r.securityAlertId)===e})):n.state.transactions.find((t=>{var r;return(null===(r=t.securityAlertResponse)||void 0===r?void 0:r.securityAlertId)===e})),t)return t;await new Promise((e=>setTimeout(e,100)))}}(r,t,s,i);o?e.addSignatureSecurityAlertResponse(n):i.updateSecurityAlertResponse(c.id,n)},r.validateRequestWithPPOM=async function({ppomController:e,request:t,securityAlertId:r,chainId:s}){try{const a=function(e){if(t=e,t.method!==u)return e;var t;const r=e.params[0],s=(0,n.normalizeTransactionParams)(r);return{...e,params:[s]}}(t),c=(0,o.isSecurityAlertsAPIEnabled)()?await async function(e,t,r){try{return{...await(0,o.validateWithSecurityAlertsAPI)(t,r),source:i.SecurityAlertSource.API}}catch(t){return d(t,"Error validating request with security alerts API"),await h(e,r)}}(e,s,a):await h(e,a);return{...c,securityAlertId:r}}catch(e){return d(e,"Error validating JSON RPC using PPOM: ")}};var n=e("@metamask/transaction-controller"),s=e("uuid"),i=e("../../../../shared/constants/security-provider"),a=e("../../../../shared/constants/transaction"),o=e("./security-alerts-api");const{sentry:c}=global,u="eth_sendTransaction",l={result_type:i.BlockaidResultType.Errored,reason:i.BlockaidReason.errored};function d(e,t){const r=function(e){if("object"==typeof e||"string"==typeof e)return e;return JSON.stringify(e)}(e),n=function(e){if(e instanceof Error)return`${e.name}: ${e.message}`;return JSON.stringify(e)}(e);return null==c||c.captureException(e),console.error(t,r),{...l,description:n}}async function h(e,t){return{...await e.usePPOM((e=>e.validateJsonRpc(t))),source:i.SecurityAlertSource.Local}}}}},{package:"$root$",file:"app/scripts/lib/ppom/ppom-util.ts"}],[8,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.PHISHING_STREAM=r.PHISHING_SAFELIST=r.METAMASK_PROVIDER=r.METAMASK_INPAGE=r.METAMASK_COOKIE_HANDLER=r.LEGACY_PUBLIC_CONFIG=r.LEGACY_PROVIDER=r.LEGACY_INPAGE=r.LEGACY_CONTENT_SCRIPT=r.CONTENT_SCRIPT=void 0;r.CONTENT_SCRIPT="metamask-contentscript",r.METAMASK_INPAGE="metamask-inpage",r.METAMASK_PROVIDER="metamask-provider",r.METAMASK_COOKIE_HANDLER="metamask-cookie-handler",r.PHISHING_SAFELIST="metamask-phishing-safelist",r.PHISHING_STREAM="phishing",r.LEGACY_CONTENT_SCRIPT="contentscript",r.LEGACY_INPAGE="inpage",r.LEGACY_PROVIDER="provider",r.LEGACY_PUBLIC_CONFIG="publicConfig"}}},{package:"$root$",file:"app/scripts/constants/stream.ts"}],[80,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){let n;Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.PPOM=void 0,r.initSync=function(e){if(n!==undefined)return n;const t=A();e instanceof WebAssembly.Module||(e=new WebAssembly.Module(e));const r=new WebAssembly.Instance(e,t);return C(r,e)},r.main=function(){n.main()};const s="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};"undefined"!=typeof TextDecoder&&s.decode();let i=null;function a(){return null!==i&&0!==i.byteLength||(i=new Uint8Array(n.memory.buffer)),i}function o(e,t){return e>>>=0,s.decode(a().subarray(e,e+t))}const c=new Array(128).fill(undefined);c.push(undefined,null,!0,!1);let u=c.length;function l(e){u===c.length&&c.push(c.length+1);const t=u;return u=c[t],c[t]=e,t}function d(e){return c[e]}function h(e){const t=d(e);return function(e){e<132||(c[e]=u,u=e)}(e),t}let f=0;const p="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},g="function"==typeof p.encodeInto?function(e,t){return p.encodeInto(e,t)}:function(e,t){const r=p.encode(e);return t.set(r),{read:e.length,written:r.length}};function m(e,t,r){if(r===undefined){const r=p.encode(e),n=t(r.length,1)>>>0;return a().subarray(n,n+r.length).set(r),f=r.length,n}let n=e.length,s=t(n,1)>>>0;const i=a();let o=0;for(;o<n;o++){const t=e.charCodeAt(o);if(t>127)break;i[s+o]=t}if(o!==n){0!==o&&(e=e.slice(o)),s=r(s,n,n=o+3*e.length,1)>>>0;const t=a().subarray(s+o,s+n);o+=g(e,t).written}return f=o,s}let y=null;function b(){return null!==y&&0!==y.byteLength||(y=new Int32Array(n.memory.buffer)),y}function _(e){const t=typeof e;if("number"==t||"boolean"==t||null==e)return`${e}`;if("string"==t)return`"${e}"`;if("symbol"==t){const t=e.description;return null==t?"Symbol":`Symbol(${t})`}if("function"==t){const t=e.name;return"string"==typeof t&&t.length>0?`Function(${t})`:"Function"}if(Array.isArray(e)){const t=e.length;let r="[";t>0&&(r+=_(e[0]));for(let n=1;n<t;n++)r+=", "+_(e[n]);return r+="]",r}const r=/\[object ([^\]]+)\]/.exec(toString.call(e));let n;if(!(r.length>1))return toString.call(e);if(n=r[1],"Object"==n)try{return"Object("+JSON.stringify(e)+")"}catch(e){return"Object"}return e instanceof Error?`${e.name}: ${e.message}\n${e.stack}`:n}function w(e,t,r){n.wasm_bindgen__convert__closures__invoke1_mut(e,t,l(r))}function v(e,t){n._dyn_core__ops__function__FnMut__A____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__destroy(e,t)}let k=null;function S(e,t){const r=t(4*e.length,4)>>>0,s=(null!==k&&0!==k.byteLength||(k=new Uint32Array(n.memory.buffer)),k);for(let t=0;t<e.length;t++)s[r/4+t]=l(e[t]);return f=e.length,r}function E(e,t){try{return e.apply(this,t)}catch(e){n.__wbindgen_exn_store(l(e))}}class T{static __wrap(e){e>>>=0;const t=Object.create(T.prototype);return t.__wbg_ptr=e,t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,e}free(){const e=this.__destroy_into_raw();n.__wbg_ppom_free(e)}static new(e,t){const r=S(t,n.__wbindgen_malloc),s=f;return h(n.ppom_new(l(e),r,s))}validateJsonRpc(e){return h(n.ppom_validateJsonRpc(this.__wbg_ptr,l(e)))}static version(){return h(n.ppom_version())}}function A(){const e={wbg:{}};return e.wbg.__wbg_buffer_085ec1f694018c4f=function(e){return l(d(e).buffer)},e.wbg.__wbg_call_01734de55d61e11d=function(){return E((function(e,t,r){return l(d(e).call(d(t),d(r)))}),arguments)},e.wbg.__wbg_call_4c92f6aec1e1d6e6=function(){return E((function(e,t,r,n){return l(d(e).call(d(t),d(r),d(n)))}),arguments)},e.wbg.__wbg_from_d7c216d4616bb368=function(e){return l(Array.from(d(e)))},e.wbg.__wbg_get_44be0491f933a435=function(e,t){return l(d(e)[t>>>0])},e.wbg.__wbg_length_72e2208bbc0efc61=function(e){return d(e).length},e.wbg.__wbg_length_d813e535247d427e=function(e){return d(e).length},e.wbg.__wbg_length_fff51ee6522a1a18=function(e){return d(e).length},e.wbg.__wbg_new_43f1b47c28813cbd=function(e,t){try{var r={a:e,b:t};const s=new Promise(((e,t)=>{const s=r.a;r.a=0;try{return function(e,t,r,s){n.wasm_bindgen__convert__closures__invoke2_mut(e,t,l(r),l(s))}(s,r.b,e,t)}finally{r.a=s}}));return l(s)}finally{r.a=r.b=0}},e.wbg.__wbg_new_8125e318e6245eed=function(e){return l(new Uint8Array(d(e)))},e.wbg.__wbg_parse_670c19d4e984792e=function(){return E((function(e,t){return l(JSON.parse(o(e,t)))}),arguments)},e.wbg.__wbg_ppom_new=function(e){return l(T.__wrap(e))},e.wbg.__wbg_resolve_53698b95aaf7fcf8=function(e){return l(Promise.resolve(d(e)))},e.wbg.__wbg_set_5cf90238115182c3=function(e,t,r){d(e).set(d(t),r>>>0)},e.wbg.__wbg_stringify_e25465938f3f611f=function(){return E((function(e){return l(JSON.stringify(d(e)))}),arguments)},e.wbg.__wbg_then_b2267541e2a73865=function(e,t,r){return l(d(e).then(d(t),d(r)))},e.wbg.__wbg_then_f7e06ee3c11698eb=function(e,t){return l(d(e).then(d(t)))},e.wbg.__wbindgen_cb_drop=function(e){const t=h(e).original;if(1==t.cnt--)return t.a=0,!0;return!1},e.wbg.__wbindgen_closure_wrapper_wasm_bindgen__closure__Closure_T___wrap__breaks_if_inlined=function(e,t,r){const n=function(e,t,r,n){const s={a:e,b:t,cnt:1},i=(...e)=>{s.cnt++;const t=s.a;s.a=0;try{return n(t,s.b,...e)}finally{0==--s.cnt?r(t,s.b):s.a=t}};return i.original=s,i}(e,t,v,w);return l(n)},e.wbg.__wbindgen_debug_string=function(e,t){const r=m(_(d(t)),n.__wbindgen_malloc,n.__wbindgen_realloc),s=f;b()[e/4+1]=s,b()[e/4+0]=r},e.wbg.__wbindgen_error_new=function(e,t){return l(new Error(o(e,t)))},e.wbg.__wbindgen_is_undefined=function(e){return d(e)===undefined},e.wbg.__wbindgen_memory=function(){return l(n.memory)},e.wbg.__wbindgen_object_drop_ref=function(e){h(e)},e.wbg.__wbindgen_string_get=function(e,t){const r=d(t),s="string"==typeof r?r:undefined;var i,a=(i=s)===undefined||null===i?0:m(s,n.__wbindgen_malloc,n.__wbindgen_realloc),o=f;b()[e/4+1]=o,b()[e/4+0]=a},e.wbg.__wbindgen_string_new=function(e,t){return l(o(e,t))},e.wbg.__wbindgen_throw=function(e,t){throw new Error(o(e,t))},e}function C(e,t){return n=e.exports,P.__wbindgen_wasm_module=t,y=null,k=null,i=null,n.__wbindgen_start(),n}async function P(e){if(n!==undefined)return n;const t=A();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:r,module:s}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const r=await e.arrayBuffer();return await WebAssembly.instantiate(r,t)}{const r=await WebAssembly.instantiate(e,t);return r instanceof WebAssembly.Instance?{instance:r,module:e}:r}}(await e,t);return C(r,s)}r.PPOM=T;r.default=P}}},{package:"$root$",file:"app/scripts/lib/ppom/ppom.js"}],[81,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getSecurityAlertsAPISupportedChainIds=async function(){return i(s)},r.isSecurityAlertsAPIEnabled=function(){return"true"==="".toString()},r.validateWithSecurityAlertsAPI=async function(e,t){return i(`${n}/${e}`,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})};const n="validate",s="supportedChains";async function i(e,t){const r=function(e){const t="http://localhost:3000";if(!t)throw new Error("Security alerts API URL is not set");return`${t}/${e}`}(e),n=await fetch(r,t);if(!n.ok)throw new Error(`Security alerts API request failed with status: ${n.status}`);return n.json()}}}},{package:"$root$",file:"app/scripts/lib/ppom/security-alerts-api.ts"}],[82,{"./handlers":88,"@metamask/permission-controller":1890,"@metamask/snaps-rpc-methods":2447,"@metamask/utils":2717,"eth-rpc-errors":3721},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createMethodMiddleware=r.createLegacyMethodMiddleware=void 0;var n=e("@metamask/permission-controller"),s=e("@metamask/snaps-rpc-methods"),i=e("@metamask/utils"),a=e("eth-rpc-errors"),o=e("./handlers");const c=[...o.handlers,...n.permissionRpcMethods.handlers];r.createMethodMiddleware=u(c),r.createLegacyMethodMiddleware=u(o.legacyHandlers);function u(e){const t=e.reduce(((e,t)=>{for(const r of t.methodNames)e[r]=t;return e}),{}),r=new Set(e.flatMap((({hookNames:e})=>Object.getOwnPropertyNames(e))));return e=>{!function(e,t){const r=[];if(t.forEach((t=>{(0,i.hasProperty)(e,t)||r.push(t)})),r.length>0)throw new Error(`Missing expected hooks:\n\n${r.join("\n")}\n`);const n=Object.getOwnPropertyNames(e).filter((e=>!t.has(e)));if(n.length>0)throw new Error(`Received unexpected hooks:\n\n${n.join("\n")}\n`)}(e,r);return async(r,n,i,o)=>{const c=t[r.method];if(c){const{implementation:t,hookNames:u}=c;try{return await t(r,n,i,o,(0,s.selectHooks)(e,u))}catch(e){return o(e instanceof Error?e:a.ethErrors.rpc.internal({data:e}))}}return i()}}}}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/createMethodMiddleware.js"}],[83,{"../../../../shared/constants/network":4959,"eth-rpc-errors":3721},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createUnsupportedMethodMiddleware=function(){return async function(e,t,r,i){return s.UNSUPPORTED_RPC_METHODS.has(e.method)?i(n.ethErrors.rpc.methodNotSupported()):r()}};var n=e("eth-rpc-errors"),s=e("../../../../shared/constants/network")}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/createUnsupportedMethodMiddleware.ts"}],[84,{"../../../../../shared/constants/app":4943,"./ethereum-chain-utils":86,"@metamask/controller-utils":1231,"eth-rpc-errors":3721},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("eth-rpc-errors"),s=e("@metamask/controller-utils"),i=e("../../../../../shared/constants/app"),a=e("./ethereum-chain-utils");const o={methodNames:[i.MESSAGE_TYPE.ADD_ETHEREUM_CHAIN],implementation:async function(e,t,r,i,{upsertNetworkConfiguration:o,getCurrentRpcUrl:c,findNetworkConfigurationBy:u,setActiveNetwork:l,requestUserApproval:d,startApprovalFlow:h,endApprovalFlow:f,getCurrentChainIdForDomain:p,getCaveat:g,requestPermittedChainsPermission:m,getChainPermissionsFeatureFlag:y}){let b;try{b=(0,a.validateAddEthereumChainParams)(e.params[0],i)}catch(e){return i(e)}const{chainId:_,chainName:w,firstValidBlockExplorerUrl:v,firstValidRPCUrl:k,ticker:S}=b,{origin:E}=e,T=p(E),A=(0,a.findExistingNetwork)(T,u),C=(0,a.findExistingNetwork)(_,u);if(C&&C.chainId===_&&C.ticker!==S)return i(n.ethErrors.rpc.invalidParams({message:`nativeCurrency.symbol does not match currency symbol for a network the user already has added with the same chainId. Received:\n${S}`}));let P,M,O;if(C&&C.rpcUrl===k){P=C.id??C.type;const e=c();if(T===_&&e===k)return t.result=null,i();M={toNetworkConfiguration:C,fromNetworkConfiguration:A}}else{({id:O}=await h());try{await d({origin:E,type:s.ApprovalType.AddEthereumChain,requestData:{chainId:_,rpcPrefs:{blockExplorerUrl:v},chainName:w,rpcUrl:k,ticker:S}}),P=await o({chainId:_,rpcPrefs:{blockExplorerUrl:v},nickname:w,rpcUrl:k,ticker:S},{source:"dapp",referrer:E})}catch(e){return f({id:O}),i(e)}M={toNetworkConfiguration:{rpcUrl:k,chainId:_,nickname:w,ticker:S,networkClientId:P},fromNetworkConfiguration:A}}return(0,a.switchChain)(t,i,E,_,M,P,O,{getChainPermissionsFeatureFlag:y,setActiveNetwork:l,requestUserApproval:d,getCaveat:g,requestPermittedChainsPermission:m,endApprovalFlow:f})},hookNames:{upsertNetworkConfiguration:!0,getCurrentRpcUrl:!0,findNetworkConfigurationBy:!0,setActiveNetwork:!0,requestUserApproval:!0,startApprovalFlow:!0,endApprovalFlow:!0,getCurrentChainIdForDomain:!0,getCaveat:!0,requestPermittedChainsPermission:!0,getChainPermissionsFeatureFlag:!0}};r.default=o}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/add-ethereum-chain.js"}],[85,{"../../../../../shared/constants/app":4943},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;const n={methodNames:[e("../../../../../shared/constants/app").MESSAGE_TYPE.ETH_ACCOUNTS],implementation:async function(e,t,r,n,{getAccounts:s}){return t.result=await s(),n()},hookNames:{getAccounts:!0}};r.default=n}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/eth-accounts.js"}],[86,{"../../../../../shared/constants/app":4943,"../../../../../shared/constants/network":4959,"../../../../../shared/constants/permissions":4963,"../../../../../shared/modules/network.utils":5004,"../../../controllers/permissions":24,"../../util":117,"@metamask/controller-utils":1231,"eth-rpc-errors":3721},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.findExistingNetwork=function(e,t){if(Object.values(i.BUILT_IN_INFURA_NETWORKS).map((({chainId:e})=>e)).includes(e))return{chainId:e,ticker:i.CURRENCY_SYMBOLS.ETH,nickname:i.NETWORK_TO_NAME_MAP[e],rpcUrl:i.CHAIN_ID_TO_RPC_URL_MAP[e],type:i.CHAIN_ID_TO_TYPE_MAP[e]};return t({chainId:e})},r.switchChain=async function(e,t,r,i,a,c,l,{getChainPermissionsFeatureFlag:d,setActiveNetwork:h,endApprovalFlow:f,requestUserApproval:p,getCaveat:g,requestPermittedChainsPermission:m}){try{if(d()){const{value:e}=g({target:u.PermissionNames.permittedChains,caveatType:o.CaveatTypes.restrictNetworkSwitching})??{};e!==undefined&&e.includes(i)||await m([i])}else await p({origin:r,type:s.ApprovalType.SwitchEthereumChain,requestData:a});await h(c),e.result=null}catch(r){return r.code===n.errorCodes.provider.userRejectedRequest&&l?(e.result=null,t()):t(r)}finally{l&&f({id:l})}return t()},r.validateAddEthereumChainParams=function(e,t){if(!e||"object"!=typeof e)throw n.ethErrors.rpc.invalidParams({message:`Expected single, object parameter. Received:\n${JSON.stringify(e)}`});const{chainId:r,chainName:s,blockExplorerUrls:i,nativeCurrency:a,rpcUrls:o,...u}=e,h=Object.keys(u).filter((e=>!["iconUrls"].includes(e)));if(h.length>0)throw n.ethErrors.rpc.invalidParams({message:`Received unexpected keys on object parameter. Unsupported keys:\n${h}`});const f=d(r);if(!o||!Array.isArray(o)||0===o.length)throw n.ethErrors.rpc.invalidParams({message:`Expected an array with at least one valid string HTTPS url 'rpcUrls', Received:\n${o}`});const p=e=>{const t=(0,l.getValidUrl)(e);return null!==t&&("localhost"===t.hostname||"127.0.0.1"===t.hostname||"https:"===t.protocol)},g=o.find((e=>p(e))),m=Array.isArray(i)?i.find((e=>p(e))):null;if(!g)throw n.ethErrors.rpc.invalidParams({message:`Expected an array with at least one valid string HTTPS url 'rpcUrls', Received:\n${o}`});if("string"!=typeof s||!s)throw n.ethErrors.rpc.invalidParams({message:`Expected non-empty string 'chainName'. Received:\n${s}`});const y=s.length>100?s.substring(0,100):s;if(null!==a){if("object"!=typeof a||Array.isArray(a))throw n.ethErrors.rpc.invalidParams({message:`Expected null or object 'nativeCurrency'. Received:\n${a}`});if(18!==a.decimals)throw n.ethErrors.rpc.invalidParams({message:`Expected the number 18 for 'nativeCurrency.decimals' when 'nativeCurrency' is provided. Received: ${a.decimals}`});if(!a.symbol||"string"!=typeof a.symbol)throw n.ethErrors.rpc.invalidParams({message:`Expected a string 'nativeCurrency.symbol'. Received: ${a.symbol}`})}const b=(null==a?void 0:a.symbol)||c.UNKNOWN_TICKER_SYMBOL;if(b!==c.UNKNOWN_TICKER_SYMBOL&&("string"!=typeof b||b.length<1||b.length>6))throw n.ethErrors.rpc.invalidParams({message:`Expected 1-6 character string 'nativeCurrency.symbol'. Received:\n${b}`});return{chainId:f,chainName:y,firstValidBlockExplorerUrl:m,firstValidRPCUrl:g,ticker:b}},r.validateChainId=d,r.validateSwitchEthereumChainParams=function(e,t){var r;if(null===(r=e.params)||void 0===r||!r[0]||"object"!=typeof e.params[0])throw n.ethErrors.rpc.invalidParams({message:`Expected single, object parameter. Received:\n${JSON.stringify(e.params)}`});const{chainId:s,...i}=e.params[0];if(Object.keys(i).length>0)throw n.ethErrors.rpc.invalidParams({message:`Received unexpected keys on object parameter. Unsupported keys:\n${Object.keys(i)}`});return d(s)};var n=e("eth-rpc-errors"),s=e("@metamask/controller-utils"),i=e("../../../../../shared/constants/network"),a=e("../../../../../shared/modules/network.utils"),o=e("../../../../../shared/constants/permissions"),c=e("../../../../../shared/constants/app"),u=e("../../../controllers/permissions"),l=e("../../util");function d(e){const t="string"==typeof e&&e.toLowerCase();if(!(0,a.isPrefixedFormattedHexString)(t))throw n.ethErrors.rpc.invalidParams({message:`Expected 0x-prefixed, unpadded, non-zero hexadecimal string 'chainId'. Received:\n${e}`});if(!(0,a.isSafeChainId)(parseInt(t,16)))throw n.ethErrors.rpc.invalidParams({message:`Invalid chain ID "${t}": numerical value greater than max safe value. Received:\n${e}`});return t}}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/ethereum-chain-utils.js"}],[87,{"../../../../../shared/constants/app":4943},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;const n={methodNames:[e("../../../../../shared/constants/app").MESSAGE_TYPE.GET_PROVIDER_STATE],implementation:async function(e,t,r,n,{getProviderState:s}){return t.result={...await s(e.origin)},n()},hookNames:{getProviderState:!0}};r.default=n}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/get-provider-state.js"}],[88,{"./add-ethereum-chain":84,"./eth-accounts":85,"./get-provider-state":87,"./log-web3-shim-usage":89,"./request-accounts":90,"./send-metadata":91,"./switch-ethereum-chain":92,"./watch-asset":93},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.legacyHandlers=r.handlers=void 0;var n=d(e("./add-ethereum-chain")),s=d(e("./eth-accounts")),i=d(e("./get-provider-state")),a=d(e("./log-web3-shim-usage")),o=d(e("./request-accounts")),c=d(e("./send-metadata")),u=d(e("./switch-ethereum-chain")),l=d(e("./watch-asset"));function d(e){return e&&e.__esModule?e:{default:e}}r.handlers=[n.default,i.default,a.default,o.default,c.default,u.default,l.default],r.legacyHandlers=[s.default]}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/index.ts"}],[89,{"../../../../../shared/constants/app":4943},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;const n={methodNames:[e("../../../../../shared/constants/app").MESSAGE_TYPE.LOG_WEB3_SHIM_USAGE],implementation:function(e,t,r,n,{getWeb3ShimUsageState:s,setWeb3ShimUsageRecorded:i}){const{origin:a}=e;s(a)===undefined&&i(a);return t.result=!0,n()},hookNames:{getWeb3ShimUsageState:!0,setWeb3ShimUsageRecorded:!0}};r.default=n}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/log-web3-shim-usage.js"}],[9,{"@metamask/base-controller":1226},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.AccountOrderController=void 0;var n=e("@metamask/base-controller");const s={pinnedAccountList:[],hiddenAccountList:[]},i={pinnedAccountList:{persist:!0,anonymous:!0},hiddenAccountList:{persist:!0,anonymous:!0}};class a extends n.BaseController{constructor({messenger:e,state:t}){super({messenger:e,metadata:i,name:"AccountOrderController",state:{...s,...t}})}updateAccountsList(e){this.update((t=>(t.pinnedAccountList=e,t)))}updateHiddenAccountsList(e){this.update((t=>(t.hiddenAccountList=e,t)))}}r.AccountOrderController=a}}},{package:"$root$",file:"app/scripts/controllers/account-order.ts"}],[90,{"../../../../../shared/constants/app":4943,"../../../../../shared/constants/metametrics":4955,"../../util":117,"eth-rpc-errors":3721},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("eth-rpc-errors"),s=e("../../../../../shared/constants/app"),i=e("../../../../../shared/constants/metametrics"),a=e("../../util");const o={methodNames:[s.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS],implementation:async function(e,t,r,o,{origin:u,getAccounts:l,getUnlockPromise:d,hasPermission:h,requestAccountsPermission:f,sendMetrics:p,getPermissionsForOrigin:g,metamaskState:m}){if(c.has(u))return t.error=n.ethErrors.rpc.resourceUnavailable(`Already processing ${s.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS}. Please wait.`),o();if(h(s.MESSAGE_TYPE.ETH_ACCOUNTS)){try{c.add(u),await d(!0),t.result=await l(),o()}catch(e){o(e)}finally{c.delete(u)}return undefined}try{await f()}catch(e){return t.error=e,o()}const y=await l();if(y.length>0){t.result=y;const e=g(u).eth_accounts.caveats[0].value.length,r=!Object.keys(m.permissionHistory).includes(u);(0,a.shouldEmitDappViewedEvent)(m.metaMetricsId)&&p({event:i.MetaMetricsEventName.DappViewed,category:i.MetaMetricsEventCategory.InpageProvider,referrer:{url:u},properties:{is_first_visit:r,number_of_accounts:Object.keys(m.accounts).length,number_of_accounts_connected:e}})}else t.error=n.ethErrors.rpc.internal("Accounts unexpectedly unavailable. Please report this bug.");return o()},hookNames:{origin:!0,getAccounts:!0,getUnlockPromise:!0,hasPermission:!0,requestAccountsPermission:!0,sendMetrics:!0,getPermissionsForOrigin:!0,metamaskState:!0}};r.default=o;const c=new Set}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/request-accounts.js"}],[91,{"../../../../../shared/constants/app":4943,"eth-rpc-errors":3721},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("eth-rpc-errors");const s={methodNames:[e("../../../../../shared/constants/app").MESSAGE_TYPE.SEND_METADATA],implementation:function(e,t,r,s,{addSubjectMetadata:i,subjectType:a}){const{origin:o,params:c}=e;if(!c||"object"!=typeof c||Array.isArray(c))return s(n.ethErrors.rpc.invalidParams({data:c}));{const{icon:e=null,name:t=null,...r}=c;i({...r,iconUrl:e,name:t,subjectType:a,origin:o})}return t.result=!0,s()},hookNames:{addSubjectMetadata:!0,subjectType:!0}};r.default=s}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/send-metadata.js"}],[92,{"../../../../../shared/constants/app":4943,"./ethereum-chain-utils":86,"eth-rpc-errors":3721},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("eth-rpc-errors"),s=e("../../../../../shared/constants/app"),i=e("./ethereum-chain-utils");const a={methodNames:[s.MESSAGE_TYPE.SWITCH_ETHEREUM_CHAIN],implementation:async function(e,t,r,a,{findNetworkConfigurationBy:o,setActiveNetwork:c,requestPermittedChainsPermission:u,getCaveat:l,getCurrentChainIdForDomain:d,requestUserApproval:h,getChainPermissionsFeatureFlag:f}){let p;try{p=(0,i.validateSwitchEthereumChainParams)(e,a)}catch(e){return a(e)}const{origin:g}=e,m=d(g);if(m===p)return t.result=null,a();const y=(0,i.findExistingNetwork)(p,o),b=(null==y?void 0:y.id)??(null==y?void 0:y.type);if(!b)return a(n.ethErrors.provider.custom({code:4902,message:`Unrecognized chain ID "${p}". Try adding the chain using ${s.MESSAGE_TYPE.ADD_ETHEREUM_CHAIN} first.`}));const _={toNetworkConfiguration:y,fromNetworkConfiguration:(0,i.findExistingNetwork)(m,o)};return(0,i.switchChain)(t,a,g,p,_,b,null,{getChainPermissionsFeatureFlag:f,setActiveNetwork:c,requestUserApproval:h,getCaveat:l,requestPermittedChainsPermission:u})},hookNames:{findNetworkConfigurationBy:!0,setActiveNetwork:!0,getCaveat:!0,requestPermittedChainsPermission:!0,getCurrentChainIdForDomain:!0,requestUserApproval:!0,getChainPermissionsFeatureFlag:!0}};r.default=a}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/switch-ethereum-chain.js"}],[93,{"../../../../../shared/constants/app":4943,"@metamask/controller-utils":1231,"eth-rpc-errors":3721},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("@metamask/controller-utils"),s=e("eth-rpc-errors"),i=e("../../../../../shared/constants/app");const a={methodNames:[i.MESSAGE_TYPE.WATCH_ASSET,i.MESSAGE_TYPE.WATCH_ASSET_LEGACY],implementation:async function(e,t,r,i,{handleWatchAssetRequest:a}){try{const{params:{options:r,type:o},origin:c,networkClientId:u}=e,{tokenId:l}=r;return[n.ERC721,n.ERC1155].includes(o)&&l!==undefined&&"string"!=typeof l?i(s.ethErrors.rpc.invalidParams({message:`Expected parameter 'tokenId' to be type 'string'. Received type '${typeof l}'`})):(await a({asset:r,type:o,origin:c,networkClientId:u}),t.result=!0,i())}catch(e){return i(e)}},hookNames:{handleWatchAssetRequest:!0}};r.default=a}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/watch-asset.js"}],[94,{"./createMethodMiddleware":82,"./createUnsupportedMethodMiddleware":83},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./createMethodMiddleware");Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===n[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return n[e]}}))}));var s=e("./createUnsupportedMethodMiddleware");Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===s[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return s[e]}}))}))}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/index.js"}],[95,{"../util":117,"@segment/loosely-validate-event":2784,buffer:3497,"is-retry-allowed":4117,lodash:4294,"remove-trailing-slash":4715,timers:4815},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t,n){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=u(e("remove-trailing-slash")),i=u(e("@segment/loosely-validate-event")),a=e("lodash"),o=u(e("is-retry-allowed")),c=e("../util");function u(e){return e&&e.__esModule?e:{default:e}}const l=()=>({});r.default=class{constructor(e,t={}){this.writeKey=e,this.host=(0,s.default)(t.host||"https://api.segment.io"),this.flushInterval=t.flushInterval||1e4,this.flushAt=t.flushAt||Math.max(t.flushAt,1)||20,this.queue=[],this.path="/v1/batch",this.maxQueueSize=460800,this.flushed=!1,this.retryCount=3,Object.defineProperty(this,"enable",{configurable:!1,writable:!1,enumerable:!0,value:!0})}_validate(e,t){(0,i.default)(e,t)}_message(e,t,r){return this._validate(t,e),this.enqueue(e,t,r),this}identify(e,t){return this._message("identify",e,t)}track(e,t){return this._message("track",e,t)}page(e,t){return this._message("page",e,t)}enqueue(e,t,r=l){if(!this.enable)return void n(r);const s={...t,type:e};if(s.context={...s.context,library:{name:"analytics-node"}},s.timestamp||(s.timestamp=new Date),s.messageId||(s.messageId=(0,c.generateRandomId)()),s.anonymousId&&!(0,a.isString)(s.anonymousId)&&(s.anonymousId=JSON.stringify(s.anonymousId)),s.userId&&!(0,a.isString)(s.userId)&&(s.userId=JSON.stringify(s.userId)),this.queue.push({message:s,callback:r}),!this.flushed)return this.flushed=!0,void this.flush();const i=this.queue.length>=this.flushAt,o=this.queue.reduce(((e,t)=>e+JSON.stringify(t).length),0)>=this.maxQueueSize;(i||o)&&this.flush(),this.flushInterval&&!this.timer&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval))}flush(e=l){if(!this.enable)return n(e),Promise.resolve();if(this.timer&&(clearTimeout(this.timer),this.timer=null),!this.queue.length)return n(e),Promise.resolve();const r=this.queue.splice(0,this.flushAt),s=r.map((e=>e.callback)),i={batch:r.map((e=>e.message)),timestamp:new Date,sentAt:new Date},a={Authorization:`Basic ${t.from(this.writeKey,"utf8").toString("base64")}`};return this._sendRequest(`${this.host}${this.path}`,{method:"POST",body:JSON.stringify(i),headers:a},(t=>{n((()=>{s.forEach((e=>e(t,i))),e(t,i)}))}),0)}_retryRequest(e,t,r,n){const s=100*Math.pow(2,n);setTimeout((()=>{this._sendRequest(e,t,r,n+1)}),s)}async _sendRequest(e,t,r,n){return fetch(e,t).then((async s=>{if(s.ok)r();else if(this._isErrorRetryable({response:s})&&n<=this.retryCount)this._retryRequest(e,t,r,n);else{const e=new Error(s.statusText);r(e)}})).catch((s=>{this._isErrorRetryable(s)&&n<=this.retryCount?this._retryRequest(e,t,r,n):r(s)}))}_isErrorRetryable(e){return!!function(e){return!e.response&&Boolean(e.code)&&"ECONNABORTED"!==e.code&&(0,o.default)(e)}(e)||!!e.response&&(e.response.status>=500&&e.response.status<=599||429===e.response.status)}}}).call(this)}).call(this,e("buffer").Buffer,e("timers").setImmediate)}}},{package:"$root$",file:"app/scripts/lib/segment/analytics.js"}],[96,{"../../../../shared/constants/time":4971,"./analytics":95},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.segment=r.createSegmentMock=void 0;var n,s=e("../../../../shared/constants/time"),i=(n=e("./analytics"))&&n.__esModule?n:{default:n};const a="XdGJ17zKf3NjBPCDQ2UDjJjkx6FYBMGP",o=undefined,c=5*s.SECOND,u=(e=o)=>{const t={queue:[],flush(){t.queue.forEach((([e,t])=>{t()})),t.queue=[]},track(r,n=(()=>undefined)){t.queue.push([r,n]),t.queue.length>=e&&t.flush()},page(){},identify(){}};return t};r.createSegmentMock=u;r.segment=a?new i.default(a,{host:null,flushAt:o,flushInterval:c}):u(o)}}},{package:"$root$",file:"app/scripts/lib/segment/index.js"}],[4,{"../../shared/constants/app":4943,"../../shared/constants/metametrics":4955,"../../shared/constants/offscreen-communication":4961,"../../shared/modules/browser-runtime.utils":4989,"../../shared/modules/mv3.utils":5003,"../../shared/modules/object.utils":5005,"../../test/e2e/background-socket/socket-background-to-mocha":5020,"../../test/e2e/default-fixture":5021,"../../test/stub/keyring-bridge":5022,"../../ui/selectors":6573,"./constants/marketing-site-whitelist":6,"./constants/sentry-state":7,"./first-time-state":35,"./lib/createStreamSink":55,"./lib/ens-ipfs/setup":62,"./lib/get-first-preferred-lang-code":64,"./lib/getObjStructure":65,"./lib/local-store":67,"./lib/migrator":70,"./lib/network-store":72,"./lib/notification-manager":73,"./lib/setup-initial-state-hooks":98,"./lib/util":117,"./metamask-controller":118,"./migrations":261,"./offscreen":262,"./platforms/extension":263,"./skip-onboarding":264,"@metamask/controller-utils":1231,"@metamask/notification-services-controller":1861,"@metamask/obs-store":1876,"@metamask/snaps-rpc-methods":2447,"@metamask/utils":2717,"debounce-stream":3639,"eth-rpc-errors":3721,events:3786,"extension-port-stream":3789,loglevel:4300,"readable-stream":4706,"webextension-polyfill":4922},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.loadStateFromPersistence=we,r.setupController=Se,r.statePersistenceEvents=void 0,e("./lib/setup-initial-state-hooks");var n=U(e("events")),s=e("readable-stream"),i=U(e("debounce-stream")),a=U(e("loglevel")),o=U(e("webextension-polyfill")),c=e("@metamask/obs-store"),u=e("@metamask/utils"),l=e("@metamask/controller-utils"),d=U(e("extension-port-stream")),h=e("eth-rpc-errors"),f=e("@metamask/snaps-rpc-methods"),p=e("@metamask/notification-services-controller"),g=e("../../shared/constants/app"),m=e("../../shared/constants/metametrics"),y=e("../../shared/modules/browser-runtime.utils"),b=e("../../shared/modules/mv3.utils"),_=e("../../shared/modules/object.utils"),w=(e("../../test/e2e/default-fixture"),e("../../test/e2e/background-socket/socket-background-to-mocha"),e("../../shared/constants/offscreen-communication"),e("../../test/stub/keyring-bridge")),v=e("../../ui/selectors"),k=U(e("./migrations")),S=U(e("./lib/migrator")),E=U(e("./platforms/extension")),T=U(e("./lib/local-store")),A=U(e("./lib/network-store")),C=e("./constants/sentry-state"),P=U(e("./lib/createStreamSink")),M=$(e("./lib/notification-manager")),O=$(e("./metamask-controller")),I=U(e("./first-time-state")),x=U(e("./lib/get-first-preferred-lang-code")),N=U(e("./lib/getObjStructure")),R=U(e("./lib/ens-ipfs/setup")),j=e("./lib/util"),L=(e("./skip-onboarding"),e("./offscreen")),q=e("./constants/marketing-site-whitelist");function D(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(D=function(e){return e?r:t})(e)}function $(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=D(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var a=s?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,r&&r.set(e,n),n}function U(e){return e&&e.__esModule?e:{default:e}}const K="#0376C9",F="#D73847",B=9,H=!1,W=H?new A.default:new T.default;global.stateHooks.getMostRecentPersistedState=()=>W.mostRecentRetrievedState;const{sentry:G}=global;let z={...I.default};const V={[g.ENVIRONMENT_TYPE_POPUP]:!0,[g.ENVIRONMENT_TYPE_NOTIFICATION]:!0,[g.ENVIRONMENT_TYPE_FULLSCREEN]:!0},Y=["trezor-connect"];a.default.setLevel("info",!1);const J=new E.default,Q=new M.default;let X=0,Z=!1,ee=!1;const te={},re={};let ne,se;const ie={};H&&(global.stateHooks.metamaskGetState=W.get.bind(W));const ae=new URL("https://metamask.github.io/phishing-warning/v3.0.3/"),oe=ae.toString(),ce=1e3,ue=r.statePersistenceEvents=new n.default,{promise:le,resolve:de,reject:he}=(0,j.deferredPromise)(),fe=async()=>{const e=await o.default.tabs.query({url:"<all_urls>",windowType:"normal"}).then((e=>((0,y.checkForLastErrorAndLog)(),e))).catch((()=>{(0,y.checkForLastErrorAndLog)()}));for(const t of e)o.default.tabs.sendMessage(t.id,{name:g.EXTENSION_MESSAGES.READY}).then((()=>{(0,y.checkForLastErrorAndLog)()})).catch((()=>{(0,y.checkForLastErrorAndLog)()}))};let pe,ge,me;function ye(){const e=(new Date).toISOString();o.default.storage.session.set({timestamp:e})}async function be(){try{const t=b.isManifestV3?(0,L.createOffscreen)():null,r=await we(),n=r.data,s=await(0,x.default)();let i;if(b.isManifestV3){var e;if(!1!==(null===(e=n.PreferencesController)||void 0===e?void 0:e.enableMV3TimestampSave)){const e=2e3;ye(),setInterval(ye,e)}const t=await o.default.storage.session.get(["isFirstMetaMaskControllerSetup"]);i=(null==t?void 0:t.isFirstMetaMaskControllerSetup)===undefined,await o.default.storage.session.set({isFirstMetaMaskControllerSetup:i})}Se(n,s,H?{keyrings:{trezorBridge:w.FakeTrezorBridge,ledgerBridge:w.FakeLedgerBridge}}:{},i,r.meta,t),function(e){async function t(e,t){try{return await o.default.tabs.update(e,{url:t})}catch(e){return null==G?void 0:G.captureException(e)}}const r=!b.isManifestV3;o.default.webRequest.onBeforeRequest.addListener((n=>{if(n.tabId===o.default.tabs.TAB_ID_NONE)return{};if(!e.onboardingController.store.getState().completedOnboarding)return{};if(!e.preferencesController.store.getState().usePhishDetect)return{};if(n.initiator&&new URL(n.initiator).host===ae.host)return{};const{hostname:s,href:i,searchParams:a}=new URL(n.url);if(H&&a.has("IN_TEST_BYPASS_EARLY_PHISHING_DETECTION"))return{};e.phishingController.maybeUpdateState();const c=e.phishingController.test(n.url),u=e.phishingController.isBlockedRequest(n.url);if(!(null!=c&&c.result||u.result))return{};let l;l=null!=c&&c.result&&u.result?`${c.type} and ${u.type}`:null!=c&&c.result?c.type:u.type,e.metaMetricsController.trackEvent({event:m.MetaMetricsEventName.PhishingPageDisplayed,category:m.MetaMetricsEventCategory.Phishing,properties:{url:s,reason:l}});const d=new URLSearchParams({hostname:s,href:i}),h=new URL(oe);h.hash=d.toString();const f=h.toString();return r?"sub_frame"===n.type?(t(n.tabId,f),{cancel:!0}):{redirectUrl:f}:(t(n.tabId,f),{})}),{types:["main_frame","sub_frame","xmlhttprequest"],urls:["http://*/*","https://*/*"]},r?["blocking"]:[])}(ne),b.isManifestV3||await async function(){let e;try{const t=new URL(oe);let r,n;t.hash="#extensionStartup",e=window.document.createElement("iframe"),e.setAttribute("src",t.href),e.setAttribute("sandbox","allow-scripts allow-same-origin");const s=new Promise(((e,t)=>{r=e,n=t}));e.addEventListener("load",r),window.document.body.appendChild(e),setTimeout((()=>n(new _e)),ce),await s}catch(e){e instanceof _e?console.warn("Phishing warning page timeout; page not guaranteed to work offline."):console.error("Failed to initialize phishing warning page",e)}finally{e&&e.remove()}}(),await fe(),a.default.info("MetaMask initialization complete."),de()}catch(e){he(e)}}o.default.runtime.onConnect.addListener((async(...e)=>{await le,pe(...e)})),o.default.runtime.onConnectExternal.addListener((async(...e)=>{var t;await le;null!==(t=e[0].sender.tab)&&void 0!==t&&t.id,ge(...e)}));class _e extends Error{constructor(){super("Timeout failed")}}async function we(){const e=new S.default({migrations:k.default,defaultVersion:null});if(e.on("error",console.warn),se=await W.get()||e.generateInitialState(z),se&&!se.data&&(se=e.generateInitialState(z),G.captureMessage("MetaMask - Empty vault found - unable to recover")),e.on("error",(e=>{const t=(0,N.default)(se);G.captureException(e,{extra:{vaultStructure:t}})})),se=await e.migrateData(se),!se)throw new Error("MetaMask - migrator returned undefined");if(!(0,u.isObject)(se.meta))throw new Error(`MetaMask - migrator metadata has invalid type '${typeof se.meta}'`);if("number"!=typeof se.meta.version)throw new Error(`MetaMask - migrator metadata version has invalid type '${typeof se.meta.version}'`);if(!(0,u.isObject)(se.data))throw new Error(`MetaMask - migrator data has invalid type '${typeof se.data}'`);return W.setMetadata(se.meta),W.set(se.data),se}function ve(e){var t;const{metaMetricsId:r}=ne.metaMetricsController.state;if(!(0,j.shouldEmitDappViewedEvent)(r))return;const n=ne.controllerMessenger.call("PermissionController:getPermissions",e),s=null==n||null===(t=n.eth_accounts)||void 0===t||null===(t=t.caveats[0])||void 0===t?void 0:t.value.length;if(!s)return;const i=ne.controllerMessenger.call("PreferencesController:getState"),a=Object.keys(i.identities).length;ne.metaMetricsController.trackEvent({event:m.MetaMetricsEventName.DappViewed,category:m.MetaMetricsEventCategory.InpageProvider,referrer:{url:e},properties:{is_first_visit:!1,number_of_accounts:a,number_of_accounts_connected:s}})}function ke(e){if(!e.sender||!e.sender.tab||!e.sender.url)return;const t=e.sender.tab.id,r=new URL(e.sender.url),{origin:n}=r;Object.keys(ie).includes(t)||(ie[t]=n);const s=ne.controllerMessenger.call("PermissionController:hasPermissions",n),i="New Tab"!==e.sender.tab.title;s&&i&&ve(n)}function Se(e,t,r,n,u,y){var w;ne=new O.default({infuraProjectId:"b6bf7d3508c941499b10025c0776eaf8",showUserConfirmation:Ee,initState:e,initLangCode:t,platform:J,notificationManager:Q,browser:o.default,getRequestAccountTabIds:()=>re,getOpenMetamaskTabsIds:()=>te,localStore:W,overrides:r,isFirstMetaMaskControllerSetup:n,currentMigrationVersion:u.version,featureFlags:{},offscreenPromise:y}),(0,R.default)({getCurrentChainId:()=>(0,v.getCurrentChainId)({metamask:ne.networkController.state}),getIpfsGateway:ne.preferencesController.getIpfsGateway.bind(ne.preferencesController),getUseAddressBarEnsResolution:()=>ne.preferencesController.store.getState().useAddressBarEnsResolution,provider:ne.provider}),(0,s.pipeline)((0,c.storeAsStream)(ne.store),(0,i.default)(1e3),(0,P.default)((async e=>{await W.set(e),ue.emit("state-persisted",e)})),(e=>{a.default.error("MetaMask - Persistence pipeline failed",e)})),w=ne,global.stateHooks.getSentryAppState=function(){const e=w.memStore.getState();return(0,_.maskObject)(e,C.SENTRY_BACKGROUND_STATE)};const k=()=>X>0||Boolean(Object.keys(te).length)||Z,S=(e,t)=>{if(!1===e)ne.onClientClosed();else{if(t===g.ENVIRONMENT_TYPE_FULLSCREEN&&Boolean(Object.keys(te).length))return;ne.onEnvironmentTypeClosed(t)}};function E(e,t){return e>t?`${t}+`:String(e)}function T(){const e=A(),t=function(){try{const{isNotificationServicesEnabled:e,isFeatureAnnouncementsEnabled:t}=ne.notificationServicesController.state,r=Object.values(ne.notificationController.state.notifications).filter((e=>null===e.readDate)).length,n=t?ne.notificationServicesController.state.metamaskNotificationsList.filter((e=>!e.isRead&&e.type===p.NotificationServicesController.Constants.TRIGGER_TYPES.FEATURES_ANNOUNCEMENT)).length:0,s=e?ne.notificationServicesController.state.metamaskNotificationsList.filter((e=>!e.isRead&&e.type!==p.NotificationServicesController.Constants.TRIGGER_TYPES.FEATURES_ANNOUNCEMENT)).length:0;return r+n+s}catch(e){return console.error("Failed to get unread notifications count:",e),0}}();let r="",n=K;e?r=E(e,B):t>0&&(r=E(t,B),n=F);try{const e={text:r},t={color:n};b.isManifestV3?(o.default.action.setBadgeText(e),o.default.action.setBadgeBackgroundColor(t)):(o.default.browserAction.setBadgeText(e),o.default.browserAction.setBadgeBackgroundColor(t))}catch(e){console.error("Error updating browser badge:",e)}}function A(){try{let e=ne.appStateController.waitingForUnlock.length+ne.approvalController.getTotalApprovalCount();return ne.preferencesController.getUseRequestQueue()&&(e+=ne.queuedRequestController.state.queuedRequestCount),e}catch(e){return console.error("Failed to get pending approval count:",e),0}}pe=async e=>{var t;const n=e.name;if(Y.includes(e.name))return;let i=!1;const a=(0,j.getPlatform)(),c=null!==(t=e.sender)&&void 0!==t&&t.url?new URL(e.sender.url):null;if(i=a===g.PLATFORM_FIREFOX?V[n]:(null==c?void 0:c.origin)===`chrome-extension://${o.default.runtime.id}`,i){var u;const t=(null==r||null===(u=r.getPortStream)||void 0===u?void 0:u.call(r,e))||new d.default(e);if(ne.isClientOpen=!0,ne.setupTrustedCommunication(t,e.sender),n===g.ENVIRONMENT_TYPE_POPUP&&(X+=1,(0,s.finished)(t,(()=>{X-=1;const e=k();ne.isClientOpen=e,S(e,g.ENVIRONMENT_TYPE_POPUP)}))),n===g.ENVIRONMENT_TYPE_NOTIFICATION&&(Z=!0,(0,s.finished)(t,(()=>{Z=!1;const e=k();ne.isClientOpen=e,S(e,g.ENVIRONMENT_TYPE_NOTIFICATION)}))),n===g.ENVIRONMENT_TYPE_FULLSCREEN){const r=e.sender.tab.id;te[r]=!0,(0,s.finished)(t,(()=>{delete te[r];const e=k();ne.isClientOpen=e,S(e,g.ENVIRONMENT_TYPE_FULLSCREEN)}))}}else if(c&&c.origin===ae.origin&&c.pathname===ae.pathname){var l;const t=(null==r||null===(l=r.getPortStream)||void 0===l?void 0:l.call(r,e))||new d.default(e);ne.setupPhishingCommunication({connectionStream:t})}else{if(e.sender&&e.sender.tab&&e.sender.url){const t=e.sender.tab.id,r=new URL(e.sender.url),{origin:n}=r;ke(e),e.onMessage.addListener((e=>{e.data&&e.data.method===g.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS&&(re[n]=t)}))}if(c&&q.COOKIE_ID_MARKETING_WHITELIST_ORIGINS.some((e=>e===c.origin))){var h;const t=(null==r||null===(h=r.getPortStream)||void 0===h?void 0:h.call(r,e))||new d.default(e);ne.setUpCookieHandlerCommunication({connectionStream:t})}ge(e)}},ge=e=>{var t;const n=(null==r||null===(t=r.getPortStream)||void 0===t?void 0:t.call(r,e))||new d.default(e);ne.setupUntrustedCommunicationEip1193({connectionStream:n,sender:e.sender})},me=async e=>{var t;if(Y.includes(e.name))return;e.sender&&e.sender.tab&&e.sender.url&&ke(e);const n=(null==r||null===(t=r.getPortStream)||void 0===t?void 0:t.call(r,e))||new d.default(e);ne.setupUntrustedCommunicationCaip({connectionStream:n,sender:e.sender})},null!=r&&r.registerConnectListeners&&r.registerConnectListeners(pe,ge),T(),ne.decryptMessageController.hub.on(O.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE,T),ne.encryptionPublicKeyController.hub.on(O.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE,T),ne.signatureController.hub.on(O.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE,T),ne.appStateController.on(O.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE,T),ne.controllerMessenger.subscribe(O.METAMASK_CONTROLLER_EVENTS.APPROVAL_STATE_CHANGE,T),ne.controllerMessenger.subscribe(O.METAMASK_CONTROLLER_EVENTS.QUEUED_REQUEST_STATE_CHANGE,T),ne.controllerMessenger.subscribe(O.METAMASK_CONTROLLER_EVENTS.METAMASK_NOTIFICATIONS_LIST_UPDATED,T),ne.controllerMessenger.subscribe(O.METAMASK_CONTROLLER_EVENTS.METAMASK_NOTIFICATIONS_MARK_AS_READ,T),ne.controllerMessenger.subscribe(O.METAMASK_CONTROLLER_EVENTS.NOTIFICATIONS_STATE_CHANGE,T),Q.on(M.NOTIFICATION_MANAGER_EVENTS.POPUP_CLOSED,(({automaticallyClosed:e})=>{e?A()>0&&Ee():(ne.signatureController.rejectUnapproved(m.REJECT_NOTIFICATION_CLOSE_SIG),ne.decryptMessageController.rejectUnapproved(m.REJECT_NOTIFICATION_CLOSE),ne.encryptionPublicKeyController.rejectUnapproved(m.REJECT_NOTIFICATION_CLOSE),Object.values(ne.approvalController.state.pendingApprovals).forEach((({id:e,type:t})=>{switch(t){case l.ApprovalType.SnapDialogAlert:case l.ApprovalType.SnapDialogPrompt:case f.DIALOG_APPROVAL_TYPES.default:ne.approvalController.accept(e,null);break;case l.ApprovalType.SnapDialogConfirmation:case g.SNAP_MANAGE_ACCOUNTS_CONFIRMATION_TYPES.confirmAccountCreation:case g.SNAP_MANAGE_ACCOUNTS_CONFIRMATION_TYPES.confirmAccountRemoval:case g.SNAP_MANAGE_ACCOUNTS_CONFIRMATION_TYPES.showSnapAccountRedirect:ne.approvalController.accept(e,!1);break;default:ne.approvalController.reject(e,h.ethErrors.provider.userRejectedRequest())}}))),T()})),Object.values(ne.snapController.state.snaps).some((e=>!e.preinstalled))&&ne.snapController.updateBlockedSnaps()}async function Ee(){const e=await J.getActiveTabs(),t=Boolean(e.find((e=>te[e.id]))),r=e.length>0&&e[0].extData&&e[0].extData.indexOf("vivaldi_tab")>-1;if(!ee&&(r||0===X)&&!t){ee=!0;try{const e=ne.appStateController.getCurrentPopupId();await Q.showPopup((e=>ne.appStateController.setCurrentPopupId(e)),e)}finally{ee=!1}}}const Te=()=>{if(ne)return ne.metaMetricsController.updateTraits({[m.MetaMetricsUserTrait.InstallDateExt]:(new Date).toISOString().split("T")[0]}),void ne.metaMetricsController.addEventBeforeMetricsOptIn({category:m.MetaMetricsEventCategory.App,event:m.MetaMetricsEventName.AppInstalled,properties:{}});setTimeout((()=>{Te()}),500)};async function Ae(){Boolean(await W.get())||(Te(),J.openExtensionInBrowser()),o.default.tabs.onActivated.addListener((e=>{if(ne){const{tabId:t}=e,r=ie[t];r&&ne.permissionController.state.subjects[r]!==undefined&&ve(r)}}))}(async function(){await Ae();try{await be(),W.cleanUpMostRecentRetrievedState()}catch(e){a.default.error(e)}})()}}},{package:"$root$",file:"app/scripts/background.js"}]],[4],{});